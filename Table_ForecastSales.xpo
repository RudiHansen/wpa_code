Exportfile for AOT version 1.0 or later
Formatversion: 1

***Element: DBT

; Microsoft Dynamics AX Table : ForecastSales unloaded
; --------------------------------------------------------------------------------
  TABLEVERSION 1
  
  TABLE #ForecastSales
    EnforceFKRelation 0
    PROPERTIES
      Name                #ForecastSales
      Label               #@SYS15056
      FormRef             #ForecastSales
      TitleField1         #ModelId
      TitleField2         #ItemId
      ConfigurationKey    #Forecast
      SecurityKey         #InventTables
      CacheLookup         #NotInTTS
      CreateRecIdIndex    #Yes
      TableGroup          #WorksheetLine
      PrimaryIndex        #RecId
      ClusterIndex        #RecId
      ModifiedBy          #Yes
      DeveloperDocumentation  #@SYS124107
      Origin              #{2C0D0090-0000-1000-0758-B49A02028574}
      LegacyId            #144
    ENDPROPERTIES
    
    FIELDS
      FIELD #Active
        ENUM
        PROPERTIES
          Name                #Active
          Label               #@Sys14584
          HelpText            #@SYS25049
          Table               #ForecastSales
          Origin              #{719D873A-6276-4D1D-A1B3-42235EDAB990}
          LegacyId            #5
          EnumType            #NoYes
        ENDPROPERTIES
        
      FIELD #ActivityNumber
        STRING
        PROPERTIES
          Name                #ActivityNumber
          Table               #ForecastSales
          IgnoreEDTRelation   #Yes
          Origin              #{AC0979A6-EB53-4B9A-9CB9-B7F690825B7E}
          LegacyId            #50
          ExtendedDataType    #ProjActivityNumber
          StringSize          #50
        ENDPROPERTIES
        
      FIELD #AllocateMethod
        ENUM
        PROPERTIES
          Name                #AllocateMethod
          Table               #ForecastSales
          Origin              #{26AB1B46-B4B5-47C3-9A3E-ED2F7D414DA9}
          LegacyId            #35
          EnumType            #BudgetAllocateMethod
        ENDPROPERTIES
        
      FIELD #Amount
        REAL
        PROPERTIES
          Name                #Amount
          Label               #@SYS12227
          HelpText            #@SYS25962
          Table               #ForecastSales
          Origin              #{E66B0888-6A3B-40C0-9ACA-B3383AF6F0F1}
          LegacyId            #33
          ExtendedDataType    #AmountCur
        ENDPROPERTIES
        
      FIELD #Comment
        STRING
        PROPERTIES
          Name                #Comment
          HelpText            #@SYS25971
          Table               #ForecastSales
          Origin              #{38488FDF-0E28-446A-841F-1F46069575DA}
          LegacyId            #9
          ExtendedDataType    #BudgetComment
          StringSize          #60
        ENDPROPERTIES
        
      FIELD #CostPrice
        REAL
        PROPERTIES
          Name                #CostPrice
          HelpText            #@SYS340357
          Table               #ForecastSales
          Origin              #{10129556-A3E4-4CB9-8A6B-9B4DC55DBAE1}
          LegacyId            #24
          ExtendedDataType    #CostPrice
        ENDPROPERTIES
        
      FIELD #Cov
        ENUM
        PROPERTIES
          Name                #Cov
          HelpText            #@SYS7656
          Table               #ForecastSales
          Origin              #{FB5F692D-D2BF-42D9-AD3C-69750B5E59B5}
          LegacyId            #26
          ExtendedDataType    #LedgerAppropriation
          EnumType            #NoYes
        ENDPROPERTIES
        
      FIELD #CovStatus
        INT
        PROPERTIES
          Name                #CovStatus
          HelpText            #@SYS25965
          AllowEditOnCreate   #No
          AllowEdit           #No
          Visible             #No
          Table               #ForecastSales
          Origin              #{A19C0F12-9149-41DA-AC5B-75F351819192}
          LegacyId            #27
          ExtendedDataType    #CovStatus
        ENDPROPERTIES
        
      FIELD #Currency
        STRING
        PROPERTIES
          Name                #Currency
          HelpText            #@SYS25969
          Mandatory           #Yes
          Table               #ForecastSales
          IgnoreEDTRelation   #Yes
          Origin              #{EE80FDFF-F045-4515-BDC3-9D83FAB88B14}
          LegacyId            #16
          ExtendedDataType    #CurrencyCode
          StringSize          #3
        ENDPROPERTIES
        
      FIELD #CustAccountId
        STRING
        PROPERTIES
          Name                #CustAccountId
          HelpText            #@SYS3649
          Table               #ForecastSales
          IgnoreEDTRelation   #Yes
          Origin              #{7DD8704F-8DCB-4A1F-A84F-68DAACD9B462}
          LegacyId            #14
          ExtendedDataType    #CustAccount
          StringSize          #20
        ENDPROPERTIES
        
      FIELD #CustGroupId
        STRING
        PROPERTIES
          Name                #CustGroupId
          HelpText            #@SYS16732
          Table               #ForecastSales
          IgnoreEDTRelation   #Yes
          Origin              #{4E6CC0BF-5C9D-48F0-9E81-AFD12D222400}
          LegacyId            #11
          ExtendedDataType    #CustGroupId
        ENDPROPERTIES
        
      FIELD #DefaultDimension
        INT64
        PROPERTIES
          Name                #DefaultDimension
          Table               #ForecastSales
          Origin              #{4B96DD15-0E96-4E3E-B2E6-C80BFDC8C486}
          LegacyId            #38
          ExtendedDataType    #DimensionDefault
        ENDPROPERTIES
        
      FIELD #DiscAmount
        REAL
        PROPERTIES
          Name                #DiscAmount
          HelpText            #@SYS9155
          Table               #ForecastSales
          Origin              #{9682422E-12CC-475A-87E2-3B63B903E175}
          LegacyId            #22
          ExtendedDataType    #DiscAmount
        ENDPROPERTIES
        
      FIELD #DiscPercent
        REAL
        PROPERTIES
          Name                #DiscPercent
          Table               #ForecastSales
          Origin              #{C0AC6381-EBFD-4A2A-887F-BC4855ECFD70}
          LegacyId            #8
          ExtendedDataType    #DiscPct
        ENDPROPERTIES
        
      FIELD #EndDate
        DATE
        PROPERTIES
          Name                #EndDate
          Label               #@SYS101261
          HelpText            #@SYS9830
          Table               #ForecastSales
          Origin              #{BA71C0AF-9BB0-4369-A646-7D72B32E040B}
          LegacyId            #3
          ExtendedDataType    #EndDate
        ENDPROPERTIES
        
      FIELD #ExpandId
        INT64
        PROPERTIES
          Name                #ExpandId
          Label               #@Sys21776
          AllowEditOnCreate   #No
          AllowEdit           #No
          Visible             #No
          Table               #ForecastSales
          IgnoreEDTRelation   #Yes
          Origin              #{EE49B804-093D-47D7-9824-C724AE6FD0DA}
          LegacyId            #17
          ExtendedDataType    #ForecastSalesRefRecId
        ENDPROPERTIES
        
      FIELD #Freq
        INT
        PROPERTIES
          Name                #Freq
          HelpText            #@SYS4591
          Table               #ForecastSales
          Origin              #{9F8CEC46-217E-430E-816E-ED211D1C92C9}
          LegacyId            #31
          ExtendedDataType    #Periods
        ENDPROPERTIES
        
      FIELD #FreqCode
        ENUM
        PROPERTIES
          Name                #FreqCode
          HelpText            #@SYS25972
          Table               #ForecastSales
          Origin              #{934683B9-90D4-4C42-BE91-9FA5473251ED}
          LegacyId            #4
          EnumType            #PeriodUnit
        ENDPROPERTIES
        
      FIELD #InventDimId
        STRING
        PROPERTIES
          Name                #InventDimId
          Visible             #No
          Table               #ForecastSales
          IgnoreEDTRelation   #Yes
          Origin              #{D24432A6-A3E0-4D8D-A9CE-3DD262BCE4A6}
          LegacyId            #42
          ExtendedDataType    #InventDimId
          StringSize          #20
        ENDPROPERTIES
        
      FIELD #InventQty
        REAL
        PROPERTIES
          Name                #InventQty
          Label               #@SYS21676
          HelpText            #@SYS10309
          Table               #ForecastSales
          Origin              #{2869A021-E0D8-4261-A8AC-32040FA54AF1}
          LegacyId            #6
          ExtendedDataType    #InventQty
        ENDPROPERTIES
        
      FIELD #ItemAllocateId
        STRING
        PROPERTIES
          Name                #ItemAllocateId
          HelpText            #@SYS25964
          Table               #ForecastSales
          IgnoreEDTRelation   #Yes
          Origin              #{FB48DBED-5B53-4D65-84AD-76725A665EF9}
          LegacyId            #28
          ExtendedDataType    #ForecastItemAllocationId
        ENDPROPERTIES
        
      FIELD #ItemBOMId
        STRING
        PROPERTIES
          Name                #ItemBOMId
          Table               #ForecastSales
          IgnoreEDTRelation   #Yes
          Origin              #{C657AC82-6A2F-4767-BA65-6436D35B07CC}
          LegacyId            #36
          ExtendedDataType    #ItemBOMId
          StringSize          #20
        ENDPROPERTIES
        
      FIELD #ItemGroupId
        STRING
        PROPERTIES
          Name                #ItemGroupId
          HelpText            #@SYS20801
          Table               #ForecastSales
          IgnoreEDTRelation   #Yes
          Origin              #{F3C8F81D-8834-46E6-9DB1-E83292A0E57A}
          LegacyId            #13
          ExtendedDataType    #ItemGroupId
        ENDPROPERTIES
        
      FIELD #ItemId
        STRING
        PROPERTIES
          Name                #ItemId
          Table               #ForecastSales
          IgnoreEDTRelation   #Yes
          Origin              #{04C8F6D6-5A0A-485A-B371-0ED82F422397}
          LegacyId            #1
          ExtendedDataType    #ItemId
          StringSize          #20
        ENDPROPERTIES
        
      FIELD #ItemRouteId
        STRING
        PROPERTIES
          Name                #ItemRouteId
          Table               #ForecastSales
          IgnoreEDTRelation   #Yes
          Origin              #{0409EE37-4AAB-4BEE-9A69-4509C55A1004}
          LegacyId            #37
          ExtendedDataType    #ItemRouteId
          StringSize          #20
        ENDPROPERTIES
        
      FIELD #KeyId
        STRING
        PROPERTIES
          Name                #KeyId
          HelpText            #@SYS16394
          Table               #ForecastSales
          IgnoreEDTRelation   #Yes
          Origin              #{0CF5CD45-258E-486D-9BEC-E208E29ACE5A}
          LegacyId            #15
          ExtendedDataType    #LedgerAllocateKeyId
        ENDPROPERTIES
        
      FIELD #ModelId
        STRING
        PROPERTIES
          Name                #ModelId
          HelpText            #@SYS25961
          Mandatory           #Yes
          Table               #ForecastSales
          IgnoreEDTRelation   #Yes
          Origin              #{36CE2944-F01D-4C34-8B24-8D371D2A978F}
          LegacyId            #34
          ExtendedDataType    #ForecastModelHeadId
        ENDPROPERTIES
        
      FIELD #PdsCWQty
        REAL
        PROPERTIES
          Name                #PdsCWQty
          Table               #ForecastSales
          Origin              #{F6997D95-261D-45DD-B484-A0466FA32466}
          LegacyId            #16001
        ENDPROPERTIES
        
      FIELD #PdsCWUnitId
        STRING
        PROPERTIES
          Name                #PdsCWUnitId
          AllowEditOnCreate   #No
          AllowEdit           #No
          Table               #ForecastSales
          Origin              #{F55BB0AE-B514-4CA9-9CF6-691F90B59781}
          LegacyId            #16002
        ENDPROPERTIES
        
      FIELD #PriceUnit
        REAL
        PROPERTIES
          Name                #PriceUnit
          HelpText            #@SYS12723
          Table               #ForecastSales
          Origin              #{83FA3758-3BEB-4AB0-A066-C898B2AB524C}
          LegacyId            #23
          ExtendedDataType    #PriceUnit
        ENDPROPERTIES
        
      FIELD #ProjCategoryId
        STRING
        PROPERTIES
          Name                #ProjCategoryId
          Table               #ForecastSales
          IgnoreEDTRelation   #Yes
          Origin              #{75671363-D870-4CC1-903B-BC0606B1A137}
          LegacyId            #40
          ExtendedDataType    #ProjCategoryId
          StringSize          #30
        ENDPROPERTIES
        
      FIELD #ProjForecastBudgetType
        ENUM
        PROPERTIES
          Name                #ProjForecastBudgetType
          AllowEditOnCreate   #No
          AllowEdit           #No
          Table               #ForecastSales
          Origin              #{38AFAAAB-2A17-4681-90B8-D332499D3185}
          LegacyId            #51
          EnumType            #ProjForecastBudgetType
        ENDPROPERTIES
        
      FIELD #ProjForecastCostPaymDate
        DATE
        PROPERTIES
          Name                #ProjForecastCostPaymDate
          Table               #ForecastSales
          Origin              #{96829803-74ED-4199-9B70-085101E842E4}
          LegacyId            #45
          ExtendedDataType    #ProjForecastCostPaymDate
        ENDPROPERTIES
        
      FIELD #ProjForecastEliminationDate
        DATE
        PROPERTIES
          Name                #ProjForecastEliminationDate
          Table               #ForecastSales
          Origin              #{9A4CC196-3286-4090-83B3-820F9545AC40}
          LegacyId            #47
          ExtendedDataType    #ProjForecastEliminationDate
        ENDPROPERTIES
        
      FIELD #ProjForecastInvoiceDate
        DATE
        PROPERTIES
          Name                #ProjForecastInvoiceDate
          Table               #ForecastSales
          Origin              #{68F354DA-AE03-4E75-83CE-C5B0C5049788}
          LegacyId            #46
          ExtendedDataType    #ProjForecastInvoiceDate
        ENDPROPERTIES
        
      FIELD #ProjForecastSalesPaymDate
        DATE
        PROPERTIES
          Name                #ProjForecastSalesPaymDate
          Table               #ForecastSales
          Origin              #{983F1787-FF20-46D9-9BEF-16D692829A3B}
          LegacyId            #44
          ExtendedDataType    #ProjForecastSalesPaymDate
        ENDPROPERTIES
        
      FIELD #ProjFundingSource
        INT64
        PROPERTIES
          Name                #ProjFundingSource
          HelpText            #@SYS330836
          Table               #ForecastSales
          Origin              #{284E1501-A9B8-4FA0-8A4A-02C7B3EA9D7B}
          LegacyId            #53
          ExtendedDataType    #ProjFundingSourceRefId
        ENDPROPERTIES
        
      FIELD #ProjId
        STRING
        PROPERTIES
          Name                #ProjId
          Table               #ForecastSales
          IgnoreEDTRelation   #Yes
          Origin              #{F6BE816D-D6A2-45E4-AA40-1968FD29D3B0}
          LegacyId            #39
          ExtendedDataType    #ProjId
          StringSize          #20
        ENDPROPERTIES
        
      FIELD #ProjLinePropertyId
        STRING
        PROPERTIES
          Name                #ProjLinePropertyId
          Table               #ForecastSales
          IgnoreEDTRelation   #Yes
          Origin              #{5D25F70B-1D92-43CA-97C0-CDEC3D7B859D}
          LegacyId            #41
          ExtendedDataType    #ProjLinePropertyId
        ENDPROPERTIES
        
      FIELD #ProjTransId
        STRING
        PROPERTIES
          Name                #ProjTransId
          AllowEditOnCreate   #No
          AllowEdit           #No
          Table               #ForecastSales
          Origin              #{AB203C29-9DF1-4EEF-87DA-ECE7C8B11508}
          LegacyId            #43
          ExtendedDataType    #ProjTransIdBase
          StringSize          #20
        ENDPROPERTIES
        
      FIELD #PSARefPurchLine
        INT64
        PROPERTIES
          Name                #PSARefPurchLine
          Table               #ForecastSales
          Origin              #{28311391-6F63-43E2-A9E6-8F6EE8CF2541}
          LegacyId            #16000
          ExtendedDataType    #PSAPurchRefRecId
        ENDPROPERTIES
        
      FIELD #RefRecId
        INT64
        PROPERTIES
          Name                #RefRecId
          Table               #ForecastSales
          Origin              #{BE2437BE-32C9-4996-9C0B-12D51E2A8684}
          ExtendedDataType    #RefRecId
        ENDPROPERTIES
        
      FIELD #Report
        ENUM
        PROPERTIES
          Name                #Report
          Label               #@Sys16399
          HelpText            #@SYS10846
          AllowEditOnCreate   #No
          AllowEdit           #No
          Table               #ForecastSales
          Origin              #{4D346DC8-2B86-4896-B073-E9416CBDC4B8}
          LegacyId            #18
          EnumType            #NoYes
        ENDPROPERTIES
        
      FIELD #SalesMarkup
        REAL
        PROPERTIES
          Name                #SalesMarkup
          HelpText            #@SYS16916
          Table               #ForecastSales
          Origin              #{463199F8-F093-4519-B4DF-B695F1CA4564}
          LegacyId            #21
          ExtendedDataType    #SalesMarkup
        ENDPROPERTIES
        
      FIELD #SalesPrice
        REAL
        PROPERTIES
          Name                #SalesPrice
          Label               #@SYS3987
          HelpText            #@SYS340356
          Table               #ForecastSales
          Origin              #{66E2D130-5EE6-4B20-8B6E-06DDBDB569D7}
          LegacyId            #7
          ExtendedDataType    #SalesPrice
        ENDPROPERTIES
        
      FIELD #SalesQty
        REAL
        PROPERTIES
          Name                #SalesQty
          HelpText            #@SYS8586
          Table               #ForecastSales
          Origin              #{4BC16D59-E395-4E8A-A9B3-EE489F0C828B}
          LegacyId            #19
          ExtendedDataType    #SalesQty
        ENDPROPERTIES
        
      FIELD #SalesUnitId
        STRING
        PROPERTIES
          Name                #SalesUnitId
          HelpText            #@SYS6379
          Table               #ForecastSales
          Origin              #{0F81CDF8-804E-429E-8ECA-ED0BD2F7C43E}
          LegacyId            #20
          ExtendedDataType    #UnitOfMeasureSymbol
        ENDPROPERTIES
        
      FIELD #StartDate
        DATE
        PROPERTIES
          Name                #StartDate
          Label               #@SYS7402
          HelpText            #@SYS13097
          Mandatory           #Yes
          Table               #ForecastSales
          Origin              #{343FB8F1-7363-4F27-96C5-9EEE87DC8132}
          LegacyId            #2
          ExtendedDataType    #StartDate
        ENDPROPERTIES
        
      FIELD #TaxGroupId
        STRING
        PROPERTIES
          Name                #TaxGroupId
          HelpText            #@SYS25963
          Table               #ForecastSales
          IgnoreEDTRelation   #Yes
          Origin              #{50C7680C-6F19-48FA-B6C1-582B62FB3380}
          LegacyId            #30
          ExtendedDataType    #TaxGroup
        ENDPROPERTIES
        
      FIELD #TaxItemGroupId
        STRING
        PROPERTIES
          Name                #TaxItemGroupId
          HelpText            #@SYS25966
          Table               #ForecastSales
          IgnoreEDTRelation   #Yes
          Origin              #{CE27A940-7C89-4962-9BBE-AB06A7070B5C}
          LegacyId            #25
          ExtendedDataType    #TaxItemGroup
        ENDPROPERTIES
        
    ENDFIELDS
    GROUPS
      GROUP #AutoReport
        PROPERTIES
          Name                #AutoReport
        ENDPROPERTIES
        
        GROUPFIELDS
          #ModelId
          #ItemId
          #StartDate
          #SalesQty
          #SalesUnitId
          #SalesPrice
          #DiscAmount
          #Amount
          #AllocateMethod
          #Freq
          #FreqCode
          #EndDate
          #KeyId
          #ItemAllocateId
          #CustAccountId
          #CustGroupId
        ENDGROUPFIELDS
      ENDGROUP
      GROUP #Allocation
        PROPERTIES
          Name                #Allocation
          Label               #@SYS12895
        ENDPROPERTIES
        
        GROUPFIELDS
          #AllocateMethod
          #Freq
          #FreqCode
          #StartDate
          #EndDate
          #KeyId
          #ItemAllocateId
        ENDGROUPFIELDS
      ENDGROUP
      GROUP #Amount
        PROPERTIES
          Name                #Amount
          Label               #@SYS6928
        ENDPROPERTIES
        
        GROUPFIELDS
          #Amount
          #Currency
        ENDGROUPFIELDS
      ENDGROUP
      GROUP #BOMRoute
        PROPERTIES
          Name                #BOMRoute
          Label               #@SYS22227
        ENDPROPERTIES
        
        GROUPFIELDS
          #ItemBOMId
          #ItemRouteId
        ENDGROUPFIELDS
      ENDGROUP
      GROUP #BudgetRevision
        PROPERTIES
          Name                #BudgetRevision
          Label               #@PSA2281
        ENDPROPERTIES
        
        GROUPFIELDS
        ENDGROUPFIELDS
      ENDGROUP
      GROUP #BudgetType
        PROPERTIES
          Name                #BudgetType
          Label               #@SYS153332
        ENDPROPERTIES
        
        GROUPFIELDS
          #ProjForecastBudgetType
        ENDGROUPFIELDS
      ENDGROUP
      GROUP #Dates
        PROPERTIES
          Name                #Dates
          Label               #@SYS80293
        ENDPROPERTIES
        
        GROUPFIELDS
          #StartDate
          #ProjForecastInvoiceDate
          #ProjForecastEliminationDate
          #ProjForecastCostPaymDate
          #ProjForecastSalesPaymDate
        ENDGROUPFIELDS
      ENDGROUP
      GROUP #Dimension
        PROPERTIES
          Name                #Dimension
          Label               #@SYS14926
        ENDPROPERTIES
        
        GROUPFIELDS
          #DefaultDimension
        ENDGROUPFIELDS
      ENDGROUP
      GROUP #Discount
        PROPERTIES
          Name                #Discount
          Label               #@SYS11829
        ENDPROPERTIES
        
        GROUPFIELDS
          #DiscAmount
          #DiscPercent
        ENDGROUPFIELDS
      ENDGROUP
      GROUP #Identification
        PROPERTIES
          Name                #Identification
          Label               #@SYS5711
        ENDPROPERTIES
        
        GROUPFIELDS
          #ItemId
          #ItemGroupId
          #CustAccountId
          #CustGroupId
          #ModelId
          #Report
        ENDGROUPFIELDS
      ENDGROUP
      GROUP #InventoryQuantity
        PROPERTIES
          Name                #InventoryQuantity
          Label               #@SYS21676
        ENDPROPERTIES
        
        GROUPFIELDS
          #InventQty
        ENDGROUPFIELDS
      ENDGROUP
      GROUP #Overview
        PROPERTIES
          Name                #Overview
          Label               #@SYS50012
        ENDPROPERTIES
        
        GROUPFIELDS
          #ProjId
          #ItemId
          #SalesQty
          #CostPrice
          #SalesUnitId
          #SalesPrice
          #Amount
          #Comment
        ENDGROUPFIELDS
      ENDGROUP
      GROUP #PdsCatchWeight
        PROPERTIES
          Name                #PdsCatchWeight
          Label               #@PDS72
        ENDPROPERTIES
        
        GROUPFIELDS
          #PdsCWQty
          #PdsCWUnitId
        ENDGROUPFIELDS
      ENDGROUP
      GROUP #Price
        PROPERTIES
          Name                #Price
          Label               #@SYS11865
        ENDPROPERTIES
        
        GROUPFIELDS
          #SalesPrice
          #CostPrice
          #PriceUnit
          #SalesMarkup
        ENDGROUPFIELDS
      ENDGROUP
      GROUP #Project
        PROPERTIES
          Name                #Project
          Label               #@SYS4534
        ENDPROPERTIES
        
        GROUPFIELDS
          #ProjId
          #ProjCategoryId
          #ProjLinePropertyId
          #PSARefPurchLine
        ENDGROUPFIELDS
      ENDGROUP
      GROUP #ProjectAdministration
        PROPERTIES
          Name                #ProjectAdministration
          Label               #@SYS9853
        ENDPROPERTIES
        
        GROUPFIELDS
          #Active
          #modifiedBy
        ENDGROUPFIELDS
      ENDGROUP
      GROUP #ProjectCostPrice
        PROPERTIES
          Name                #ProjectCostPrice
          Label               #@SYS13134
        ENDPROPERTIES
        
        GROUPFIELDS
          #SalesQty
          #CostPrice
          #costAmount
        ENDGROUPFIELDS
      ENDGROUP
      GROUP #ProjectIdentification
        PROPERTIES
          Name                #ProjectIdentification
          Label               #@SYS89920
        ENDPROPERTIES
        
        GROUPFIELDS
          #StartDate
          #ProjId
          #ProjFundingSource
          #ActivityNumber
          #ProjCategoryId
          #ItemId
          #ProjLinePropertyId
        ENDGROUPFIELDS
      ENDGROUP
      GROUP #ProjectSalesPrice
        PROPERTIES
          Name                #ProjectSalesPrice
          Label               #@SYS5755
        ENDPROPERTIES
        
        GROUPFIELDS
          #Currency
          #SalesUnitId
          #SalesPrice
        ENDGROUPFIELDS
      ENDGROUP
      GROUP #ProjectTransaction
        PROPERTIES
          Name                #ProjectTransaction
          Label               #@SYS15191
        ENDPROPERTIES
        
        GROUPFIELDS
          #ProjTransId
        ENDGROUPFIELDS
      ENDGROUP
      GROUP #PSA
        PROPERTIES
          Name                #PSA
          Label               #@PSA43
        ENDPROPERTIES
        
        GROUPFIELDS
          #ItemId
          #itemName
          #SalesQty
          #SalesUnitId
          #CostPrice
          #SalesPrice
          #PSAdispcostValue
          #Amount
          #PSAcontribution
          #ProjCategoryId
          #ModelId
          #ProjId
        ENDGROUPFIELDS
      ENDGROUP
      GROUP #PSAOriginalBudgetInventory
        PROPERTIES
          Name                #PSAOriginalBudgetInventory
          Label               #@PSA2522
        ENDPROPERTIES
        
        GROUPFIELDS
          #InventQty
          #ItemBOMId
          #ItemRouteId
        ENDGROUPFIELDS
      ENDGROUP
      GROUP #PSAOriginalBudgetPrice
        PROPERTIES
          Name                #PSAOriginalBudgetPrice
          Label               #@PSA2570
        ENDPROPERTIES
        
        GROUPFIELDS
          #CostPrice
          #SalesPrice
        ENDGROUPFIELDS
      ENDGROUP
      GROUP #SalesForecast
        PROPERTIES
          Name                #SalesForecast
          Label               #@SYS15056
        ENDPROPERTIES
        
        GROUPFIELDS
          #Comment
          #Active
          #Cov
        ENDGROUPFIELDS
      ENDGROUP
      GROUP #SalesQuantity
        PROPERTIES
          Name                #SalesQuantity
          Label               #@SYS11990
        ENDPROPERTIES
        
        GROUPFIELDS
          #SalesQty
          #SalesUnitId
        ENDGROUPFIELDS
      ENDGROUP
      GROUP #SalesTax
        PROPERTIES
          Name                #SalesTax
          Label               #@SYS5878
        ENDPROPERTIES
        
        GROUPFIELDS
          #TaxGroupId
          #TaxItemGroupId
        ENDGROUPFIELDS
      ENDGROUP
      GROUP #Service
        PROPERTIES
          Name                #Service
          Label               #@SYS25500
        ENDPROPERTIES
        
        GROUPFIELDS
          #SalesUnitId
          #SalesQty
          #InventQty
        ENDGROUPFIELDS
      ENDGROUP
    ENDGROUPS
    
    INDICES
      #ItemIdx
      PROPERTIES
        Name                #ItemIdx
        Origin              #{2B070001-0090-1000-4974-656D49647800}
        LegacyId            #1
      ENDPROPERTIES
      
      INDEXFIELDS
        #ItemId
        #ModelId
        #StartDate
      ENDINDEXFIELDS
      
      #ModelIdx
      PROPERTIES
        Name                #ModelIdx
        Origin              #{2B080002-0090-1000-4D6F-64656C496478}
        LegacyId            #2
      ENDPROPERTIES
      
      INDEXFIELDS
        #ModelId
      ENDINDEXFIELDS
      
      #AccountIdx
      PROPERTIES
        Name                #AccountIdx
        Origin              #{2B0A0003-0090-1000-CD51-C781756E7449}
        LegacyId            #3
      ENDPROPERTIES
      
      INDEXFIELDS
        #CustAccountId
        #ModelId
        #StartDate
      ENDINDEXFIELDS
      
      #ItemGroupIdx
      PROPERTIES
        Name                #ItemGroupIdx
        Origin              #{2B0C0004-0090-1000-1943-2967AB846F75}
        LegacyId            #4
      ENDPROPERTIES
      
      INDEXFIELDS
        #ItemGroupId
        #ItemId
        #ModelId
        #StartDate
      ENDINDEXFIELDS
      
      #AccounGrouptIdx
      PROPERTIES
        Name                #AccounGrouptIdx
        Origin              #{2B0F0005-0090-1000-F6AE-23D9F13241D6}
        LegacyId            #5
      ENDPROPERTIES
      
      INDEXFIELDS
        #CustGroupId
        #CustAccountId
        #ModelId
        #StartDate
      ENDINDEXFIELDS
      
      #ExpandIdx
      PROPERTIES
        Name                #ExpandIdx
        AllowDuplicates     #No
        Origin              #{2B090006-0090-1000-EDCC-82616E644964}
        LegacyId            #6
      ENDPROPERTIES
      
      INDEXFIELDS
        #ExpandId
        #RecId
      ENDINDEXFIELDS
      
      #CovIdx
      PROPERTIES
        Name                #CovIdx
        Origin              #{2B060007-0090-1000-436F-764964780000}
        LegacyId            #7
      ENDPROPERTIES
      
      INDEXFIELDS
        #CovStatus
      ENDINDEXFIELDS
      
      #ProjIdx
      PROPERTIES
        Name                #ProjIdx
        Origin              #{2B070008-0090-1000-5072-6F6A49647800}
        LegacyId            #8
      ENDPROPERTIES
      
      INDEXFIELDS
        #ProjCategoryId
        #ProjId
        #ModelId
      ENDINDEXFIELDS
      
      #ProjTransIdx
      PROPERTIES
        Name                #ProjTransIdx
        Origin              #{2B0C0009-0090-1000-71B6-3364B884616E}
        LegacyId            #9
      ENDPROPERTIES
      
      INDEXFIELDS
        #ProjTransId
      ENDINDEXFIELDS
      
      #ProjFundingSourceIdx
      PROPERTIES
        Name                #ProjFundingSourceIdx
        Origin              #{0F1066F9-3AFF-4BBF-9FD7-05AAEB1F8E6D}
        LegacyId            #12
      ENDPROPERTIES
      
      INDEXFIELDS
        #ProjFundingSource
      ENDINDEXFIELDS
      
      #PSARefPurchRecIdIdx
      PROPERTIES
        Name                #PSARefPurchRecIdIdx
        Origin              #{DF94541B-7C80-4013-84EC-FF24D4C1512F}
        LegacyId            #16003
      ENDPROPERTIES
      
      INDEXFIELDS
        #PSARefPurchLine
      ENDINDEXFIELDS
      
    ENDINDICES
    FULLTEXTINDICES
    ENDFULLTEXTINDICES
    REFERENCES
      REFERENCE #Currency
        PROPERTIES
          Name                #Currency
          Table               #Currency
          RelatedTableCardinality   #ExactlyOne
          Cardinality         #ZeroMore
          RelationshipType    #Association
          UseDefaultRoleNames #Yes
        ENDPROPERTIES
        
        FIELDREFERENCES
          REFERENCETYPE PKFK
          PROPERTIES
            Field               #Currency
            RelatedField        #CurrencyCode
          ENDPROPERTIES
          
        ENDFIELDREFERENCES
      ENDREFERENCE
      REFERENCE #CustGroup
        PROPERTIES
          Name                #CustGroup
          Table               #CustGroup
          RelatedTableCardinality   #ZeroOne
          Cardinality         #ZeroMore
          RelationshipType    #Association
          UseDefaultRoleNames #Yes
        ENDPROPERTIES
        
        FIELDREFERENCES
          REFERENCETYPE PKFK
          PROPERTIES
            Field               #CustGroupId
            RelatedField        #CustGroup
          ENDPROPERTIES
          
        ENDFIELDREFERENCES
      ENDREFERENCE
      REFERENCE #CustTable
        PROPERTIES
          Name                #CustTable
          Table               #CustTable
          RelatedTableCardinality   #ZeroOne
          Cardinality         #ZeroMore
          RelationshipType    #Association
          UseDefaultRoleNames #Yes
        ENDPROPERTIES
        
        FIELDREFERENCES
          REFERENCETYPE PKFK
          PROPERTIES
            Field               #CustAccountId
            RelatedField        #AccountNum
          ENDPROPERTIES
          
        ENDFIELDREFERENCES
      ENDREFERENCE
      REFERENCE #DefaultDimension
        PROPERTIES
          Name                #DefaultDimension
          Table               #DimensionAttributeValueSet
          RelatedTableCardinality   #ZeroOne
          Cardinality         #ZeroMore
          RelationshipType    #Association
          RelatedTableRole    #DefaultDimension
          Role                #SalesForecast
        ENDPROPERTIES
        
        FIELDREFERENCES
          REFERENCETYPE PKFK
          PROPERTIES
            Field               #DefaultDimension
            RelatedField        #RecId
          ENDPROPERTIES
          
        ENDFIELDREFERENCES
      ENDREFERENCE
      REFERENCE #ExpandForecastSales
        PROPERTIES
          Name                #ExpandForecastSales
          Table               #ForecastSales
          RelatedTableCardinality   #ZeroOne
          Cardinality         #ZeroMore
          RelationshipType    #Association
          UseDefaultRoleNames #Yes
        ENDPROPERTIES
        
        FIELDREFERENCES
          REFERENCETYPE PKFK
          PROPERTIES
            Field               #ExpandId
            RelatedField        #RecId
          ENDPROPERTIES
          
        ENDFIELDREFERENCES
      ENDREFERENCE
      REFERENCE #ForecastItemAllocation
        PROPERTIES
          Name                #ForecastItemAllocation
          Table               #ForecastItemAllocation
          RelatedTableCardinality   #ZeroOne
          Cardinality         #ZeroMore
          RelationshipType    #Association
          UseDefaultRoleNames #Yes
        ENDPROPERTIES
        
        FIELDREFERENCES
          REFERENCETYPE PKFK
          PROPERTIES
            Field               #ItemAllocateId
            RelatedField        #AllocateId
          ENDPROPERTIES
          
        ENDFIELDREFERENCES
      ENDREFERENCE
      REFERENCE #ForecastModel
        PROPERTIES
          Name                #ForecastModel
          Table               #ForecastModel
          RelatedTableCardinality   #ExactlyOne
          Cardinality         #ZeroMore
          RelationshipType    #Association
          UseDefaultRoleNames #Yes
        ENDPROPERTIES
        
        FIELDREFERENCES
          REFERENCETYPE NORMAL
          PROPERTIES
            Field               #ModelId
            RelatedField        #ModelId
          ENDPROPERTIES
          
          REFERENCETYPE EXTERNFIXED
          PROPERTIES
            Table               #ForecastModel
            RelatedField        #Type
          ENDPROPERTIES
          
        ENDFIELDREFERENCES
      ENDREFERENCE
      REFERENCE #InventDim
        PROPERTIES
          Name                #InventDim
          Table               #InventDim
          RelatedTableCardinality   #ZeroOne
          Cardinality         #ZeroMore
          RelationshipType    #Association
          UseDefaultRoleNames #Yes
        ENDPROPERTIES
        
        FIELDREFERENCES
          REFERENCETYPE PKFK
          PROPERTIES
            Field               #InventDimId
            RelatedField        #inventDimId
          ENDPROPERTIES
          
        ENDFIELDREFERENCES
      ENDREFERENCE
      REFERENCE #InventItemGroup
        PROPERTIES
          Name                #InventItemGroup
          Table               #InventItemGroup
          RelatedTableCardinality   #ZeroOne
          Cardinality         #ZeroMore
          RelationshipType    #Association
          UseDefaultRoleNames #Yes
        ENDPROPERTIES
        
        FIELDREFERENCES
          REFERENCETYPE PKFK
          PROPERTIES
            Field               #ItemGroupId
            RelatedField        #ItemGroupId
          ENDPROPERTIES
          
        ENDFIELDREFERENCES
      ENDREFERENCE
      REFERENCE #InventTable
        PROPERTIES
          Name                #InventTable
          Table               #InventTable
          RelatedTableCardinality   #ZeroOne
          Cardinality         #ZeroMore
          RelationshipType    #Aggregation
          UseDefaultRoleNames #Yes
        ENDPROPERTIES
        
        FIELDREFERENCES
          REFERENCETYPE PKFK
          PROPERTIES
            Field               #ItemId
            RelatedField        #ItemId
          ENDPROPERTIES
          
        ENDFIELDREFERENCES
      ENDREFERENCE
      REFERENCE #LedgerAllocateKey
        PROPERTIES
          Name                #LedgerAllocateKey
          Table               #LedgerAllocateKey
          RelatedTableCardinality   #ZeroOne
          Cardinality         #ZeroMore
          RelationshipType    #Association
          UseDefaultRoleNames #Yes
        ENDPROPERTIES
        
        FIELDREFERENCES
          REFERENCETYPE PKFK
          PROPERTIES
            Field               #KeyId
            RelatedField        #Key
          ENDPROPERTIES
          
        ENDFIELDREFERENCES
      ENDREFERENCE
      REFERENCE #ProjCategory
        PROPERTIES
          Name                #ProjCategory
          Table               #ProjCategory
          RelatedTableCardinality   #ZeroOne
          Cardinality         #ZeroMore
          RelationshipType    #Association
          UseDefaultRoleNames #Yes
        ENDPROPERTIES
        
        FIELDREFERENCES
          REFERENCETYPE PKFK
          PROPERTIES
            Field               #ProjCategoryId
            RelatedField        #CategoryId
          ENDPROPERTIES
          
        ENDFIELDREFERENCES
      ENDREFERENCE
      REFERENCE #ProjForecastEmpl
        PROPERTIES
          Name                #ProjForecastEmpl
          Table               #ProjForecastEmpl
          UseDefaultRoleNames #Yes
        ENDPROPERTIES
        
        FIELDREFERENCES
          REFERENCETYPE NORMAL
          PROPERTIES
            Field               #RefRecId
            RelatedField        #RecId
          ENDPROPERTIES
          
        ENDFIELDREFERENCES
      ENDREFERENCE
      REFERENCE #ProjFundingSource
        PROPERTIES
          Name                #ProjFundingSource
          Table               #ProjFundingSource
          RelatedTableCardinality   #ZeroOne
          Cardinality         #ZeroMore
          RelationshipType    #Association
          RelatedTableRole    #ProjFundingSource
          Role                #ProjFundingSource_ForecastSales
        ENDPROPERTIES
        
        FIELDREFERENCES
          REFERENCETYPE PKFK
          PROPERTIES
            Field               #ProjFundingSource
            RelatedField        #RecId
          ENDPROPERTIES
          
        ENDFIELDREFERENCES
      ENDREFERENCE
      REFERENCE #ProjLineProperty
        PROPERTIES
          Name                #ProjLineProperty
          Table               #ProjLineProperty
          RelatedTableCardinality   #ZeroOne
          Cardinality         #ZeroMore
          RelationshipType    #Association
          UseDefaultRoleNames #Yes
        ENDPROPERTIES
        
        FIELDREFERENCES
          REFERENCETYPE PKFK
          PROPERTIES
            Field               #ProjLinePropertyId
            RelatedField        #LinePropertyId
          ENDPROPERTIES
          
        ENDFIELDREFERENCES
      ENDREFERENCE
      REFERENCE #ProjTable
        PROPERTIES
          Name                #ProjTable
          Table               #ProjTable
          RelatedTableCardinality   #ZeroOne
          Cardinality         #ZeroMore
          RelationshipType    #Aggregation
          UseDefaultRoleNames #Yes
        ENDPROPERTIES
        
        FIELDREFERENCES
          REFERENCETYPE PKFK
          PROPERTIES
            Field               #ProjId
            RelatedField        #ProjId
          ENDPROPERTIES
          
        ENDFIELDREFERENCES
      ENDREFERENCE
      REFERENCE #PurchLine
        PROPERTIES
          Name                #PurchLine
          Table               #PurchLine
          RelatedTableCardinality   #ZeroOne
          Cardinality         #ZeroMore
          RelationshipType    #Association
          UseDefaultRoleNames #Yes
          EDTRelation         #Yes
        ENDPROPERTIES
        
        FIELDREFERENCES
          REFERENCETYPE PKFK
          PROPERTIES
            Field               #PSARefPurchLine
            RelatedField        #RecId
            SourceEDT           #PSAPurchRefRecId
          ENDPROPERTIES
          
        ENDFIELDREFERENCES
      ENDREFERENCE
      REFERENCE #RouteTable
        PROPERTIES
          Name                #RouteTable
          Table               #RouteTable
          RelatedTableCardinality   #ZeroOne
          Cardinality         #ZeroMore
          RelationshipType    #Association
          UseDefaultRoleNames #Yes
        ENDPROPERTIES
        
        FIELDREFERENCES
          REFERENCETYPE PKFK
          PROPERTIES
            Field               #ItemRouteId
            RelatedField        #RouteId
          ENDPROPERTIES
          
        ENDFIELDREFERENCES
      ENDREFERENCE
      REFERENCE #SalesUnitId
        PROPERTIES
          Name                #SalesUnitId
          Table               #UnitOfMeasure
          RelatedTableCardinality   #ZeroOne
          Cardinality         #ZeroMore
          RelationshipType    #Association
          RelatedTableRole    #Unit
          Role                #DemandForecast
        ENDPROPERTIES
        
        FIELDREFERENCES
          REFERENCETYPE NORMAL
          PROPERTIES
            Field               #SalesUnitId
            RelatedField        #Symbol
          ENDPROPERTIES
          
        ENDFIELDREFERENCES
      ENDREFERENCE
      REFERENCE #smmActivities
        PROPERTIES
          Name                #smmActivities
          Table               #smmActivities
          RelatedTableCardinality   #ZeroOne
          Cardinality         #ZeroMore
          RelationshipType    #Association
          UseDefaultRoleNames #Yes
        ENDPROPERTIES
        
        FIELDREFERENCES
          REFERENCETYPE PKFK
          PROPERTIES
            Field               #ActivityNumber
            RelatedField        #ActivityNumber
          ENDPROPERTIES
          
        ENDFIELDREFERENCES
      ENDREFERENCE
      REFERENCE #SubBOMTable
        PROPERTIES
          Name                #SubBOMTable
          Table               #BOMTable
          RelatedTableCardinality   #ZeroOne
          Cardinality         #ZeroMore
          RelationshipType    #Association
          UseDefaultRoleNames #Yes
        ENDPROPERTIES
        
        FIELDREFERENCES
          REFERENCETYPE PKFK
          PROPERTIES
            Field               #ItemBOMId
            RelatedField        #BOMId
          ENDPROPERTIES
          
        ENDFIELDREFERENCES
      ENDREFERENCE
      REFERENCE #TaxGroupHeading
        PROPERTIES
          Name                #TaxGroupHeading
          Table               #TaxGroupHeading
          RelatedTableCardinality   #ZeroOne
          Cardinality         #ZeroMore
          RelationshipType    #Association
          UseDefaultRoleNames #Yes
        ENDPROPERTIES
        
        FIELDREFERENCES
          REFERENCETYPE PKFK
          PROPERTIES
            Field               #TaxGroupId
            RelatedField        #TaxGroup
          ENDPROPERTIES
          
        ENDFIELDREFERENCES
      ENDREFERENCE
      REFERENCE #TaxItemGroupHeading
        PROPERTIES
          Name                #TaxItemGroupHeading
          Table               #TaxItemGroupHeading
          RelatedTableCardinality   #ZeroOne
          Cardinality         #ZeroMore
          RelationshipType    #Association
          UseDefaultRoleNames #Yes
        ENDPROPERTIES
        
        FIELDREFERENCES
          REFERENCETYPE PKFK
          PROPERTIES
            Field               #TaxItemGroupId
            RelatedField        #TaxItemGroup
          ENDPROPERTIES
          
        ENDFIELDREFERENCES
      ENDREFERENCE
    ENDREFERENCES
    
    DELETEACTIONS
      #ProjTransBudget
      PROPERTIES
        Table               #ProjTransBudget
        DeleteAction        #Cascade
      ENDPROPERTIES
      
    ENDDELETEACTIONS
    
    METHODS
      SOURCE #accountClearingLedgerDimension
        #LedgerDimensionDefaultAccount accountClearingLedgerDimension()
        #{
        #    // <GEERU>
        #    #isoCountryRegionCodes
        #    // </GEERU>
        #    // <GEERU>
        #    if (SysCountryRegionCode::isLegalEntityInCountryRegion([#isoRU])
        #        && this.postingProfile_RU())
        #    {
        #        return CustLedgerAccounts::clearingLedgerDimension(this.invoiceAccount(), this.postingProfile_RU());
        #    }
        #    // </GEERU>
        #    return CustLedgerAccounts::clearingLedgerDimension(this.invoiceAccount(),
        #                                                       CustParameters::find().PostingProfile);
        #}
      ENDSOURCE
      SOURCE #accountConsumption
        #LedgerDimensionDefaultAccount accountConsumption()
        #{
        #    // <GEERU>
        #    #isoCountryRegionCodes
        #
        #    if (SysCountryRegionCode::isLegalEntityInCountryRegion([#isoRU]))
        #    {
        #        return InventPosting::accountItemLedgerDimension(
        #            InventAccountType::SalesConsump,
        #            this.ItemId,
        #            this.ItemGroupId,
        #            0, // If a category relation is added to the table it can be supplied here
        #            this.CustAccountId,
        #            this.CustGroupId,
        #            this.TaxGroupId,
        #            this.inventDim());
        #    }
        #    // </GEERU>
        #    return  InventPosting::accountItemLedgerDimension(
        #            InventAccountType::SalesConsump,
        #            this.ItemId,
        #            this.ItemGroupId,
        #            0, // If a category relation is added to the table it can be supplied here
        #            this.CustAccountId,
        #            this.CustGroupId,
        #            this.TaxGroupId);
        #}
      ENDSOURCE
      SOURCE #accountConsumptionLedgerDimension
        #/// <summary>
        #/// Gets the default account for the sales order consumption from the inventory posting profile.
        #/// </summary>
        #/// <returns>
        #/// The default account.
        #/// </returns>
        #public LedgerDimensionDefaultAccount accountConsumptionLedgerDimension()
        #{
        #    // <GEERU>
        #    #isoCountryRegionCodes
        #
        #    if (SysCountryRegionCode::isLegalEntityInCountryRegion([#isoRU]))
        #    {
        #        return InventPosting::accountItemLedgerDimension(
        #            InventAccountType::SalesConsump,
        #            this.ItemId,
        #            this.ItemGroupId,
        #            0, // If a category relation is added to the table it can be supplied here
        #            this.CustAccountId,
        #            this.CustGroupId,
        #            this.TaxGroupId,
        #            this.inventDim());
        #    }
        #    // </GEERU>
        #    return InventPosting::accountItemLedgerDimension(
        #        InventAccountType::SalesConsump,
        #        this.ItemId,
        #        this.ItemGroupId,
        #        0, // If a category relation is added to the table it can be supplied here
        #        this.CustAccountId,
        #        this.CustGroupId,
        #        this.TaxGroupId);
        #}
      ENDSOURCE
      SOURCE #accountCustLedgerDimension
        #LedgerDimensionDefaultAccount accountCustLedgerDimension(TransStatusCode postingProfile  ='')
        #{
        #    // <GEERU>
        #    #isoCountryRegionCodes
        #
        #    if (SysCountryRegionCode::isLegalEntityInCountryRegion([#isoRU])
        #        && this.postingProfile_RU())
        #    {
        #        return CustLedgerAccounts::summaryLedgerDimension(this.invoiceAccount(), this.postingProfile_RU());
        #    }
        #    // </GEERU>
        #    return CustLedgerAccounts::summaryLedgerDimension(this.invoiceAccount(),postingProfile);
        #}
      ENDSOURCE
      SOURCE #accountDisc
        #LedgerDimensionDefaultAccount accountDisc()
        #{
        #    // <GEERU>
        #    #isoCountryRegionCodes
        #
        #    if (SysCountryRegionCode::isLegalEntityInCountryRegion([#isoRU]))
        #    {
        #        return InventPosting::accountItemLedgerDimension(
        #            InventAccountType::SalesDisc,
        #            this.ItemId,
        #            this.ItemGroupId,
        #            0, // If a category relation is added to the table it can be supplied here
        #            this.CustAccountId,
        #            this.CustGroupId,
        #            this.TaxGroupId,
        #            this.inventDim());
        #    }
        #    // </GEERU>
        #    return  InventPosting::accountItemLedgerDimension(
        #            InventAccountType::SalesDisc,
        #            this.ItemId,
        #            this.ItemGroupId,
        #            0, // If a category relation is added to the table it can be supplied here
        #            this.CustAccountId,
        #            this.CustGroupId,
        #            this.TaxGroupId);
        #}
      ENDSOURCE
      SOURCE #accountDiscLedgerDimension
        #/// <summary>
        #/// Gets the default account for the sales order discount from the inventory posting profile.
        #/// </summary>
        #/// <returns>
        #/// The default account.
        #/// </returns>
        #public LedgerDimensionDefaultAccount accountDiscLedgerDimension()
        #{
        #    // <GEERU>
        #    #isoCountryRegionCodes
        #
        #    if (SysCountryRegionCode::isLegalEntityInCountryRegion([#isoRU]))
        #    {
        #        return InventPosting::accountItemLedgerDimension(
        #            InventAccountType::SalesDisc,
        #            this.ItemId,
        #            this.ItemGroupId,
        #            0, // If a category relation is added to the table it can be supplied here
        #            this.CustAccountId,
        #            this.CustGroupId,
        #            this.TaxGroupId,
        #            this.inventDim());
        #    }
        #    // </GEERU>
        #    return InventPosting::accountItemLedgerDimension(
        #        InventAccountType::SalesDisc,
        #        this.ItemId,
        #        this.ItemGroupId,
        #        0, // If a category relation is added to the table it can be supplied here
        #        this.CustAccountId,
        #        this.CustGroupId,
        #        this.TaxGroupId);
        #
        #}
      ENDSOURCE
      SOURCE #accountIssue
        #LedgerDimensionDefaultAccount accountIssue()
        #{
        #    // <GEERU>
        #    #isoCountryRegionCodes
        #
        #    if (SysCountryRegionCode::isLegalEntityInCountryRegion([#isoRU]))
        #    {
        #        return InventPosting::accountItemLedgerDimension(
        #            InventAccountType::SalesIssue,
        #            this.ItemId,
        #            this.ItemGroupId,
        #            0, // If a category relation is added to the table it can be supplied here
        #            this.CustAccountId,
        #            this.CustGroupId,
        #            this.TaxGroupId,
        #            this.inventDim());
        #    }
        #    // </GEERU>
        #    // <GCN>
        #    if (InventPostingExtendParm_CN::checkExtendParmEnabled())
        #    {
        #        return InventPosting::accountItemExtendParm_CN(
        #            InventAccountType::SalesIssue,
        #            InventPostingExtendParm_CN::constructInventDim(this.inventDim()),
        #            this.ItemId,
        #            this.ItemGroupId,
        #            0, // If a category relation is added to the table it can be supplied here
        #            this.CustAccountId,
        #            this.CustGroupId,
        #            this.TaxGroupId);
        #    }
        #    // </GCN>
        #    return  InventPosting::accountItemLedgerDimension(
        #            InventAccountType::SalesIssue,
        #            this.ItemId,
        #            this.ItemGroupId,
        #            0, // If a category relation is added to the table it can be supplied here
        #            this.CustAccountId,
        #            this.CustGroupId,
        #            this.TaxGroupId);
        #}
      ENDSOURCE
      SOURCE #accountSales
        #LedgerDimensionDefaultAccount accountSales()
        #{
        #    // <GEERU>
        #    #isoCountryRegionCodes
        #    // </GEERU>
        #    // <GEERU>
        #    if (SysCountryRegionCode::isLegalEntityInCountryRegion([#isoRU]))
        #    {
        #        return InventPosting::accountItemLedgerDimension(
        #            InventAccountType::SalesRevenue,
        #            this.ItemId,
        #            this.ItemGroupId,
        #            0, // If a category relation is added to the table it can be supplied here
        #            this.CustAccountId,
        #            this.CustGroupId,
        #            this.TaxGroupId,
        #            this.inventDim());
        #    }
        #    // </GEERU>
        #    return  InventPosting::accountItemLedgerDimension(
        #            InventAccountType::SalesRevenue,
        #            this.ItemId,
        #            this.ItemGroupId,
        #            0, // If a category relation is added to the table it can be supplied here
        #            this.CustAccountId,
        #            this.CustGroupId,
        #            this.TaxGroupId);
        #}
      ENDSOURCE
      SOURCE #accountSalesLedgerDimension
        #/// <summary>
        #/// Gets the default account for the sales order revenue from the inventory posting profile.
        #/// </summary>
        #/// <returns>
        #/// The default account.
        #/// </returns>
        #public LedgerDimensionDefaultAccount accountSalesLedgerDimension()
        #{
        #    return InventPosting::accountItemLedgerDimension(
        #        InventAccountType::SalesRevenue,
        #        this.ItemId,
        #        this.ItemGroupId,
        #        0, // If a category relation is added to the table it can be supplied here
        #        this.CustAccountId,
        #        this.CustGroupId,
        #        this.TaxGroupId);
        #}
      ENDSOURCE
      SOURCE #blankDateFields
        #private void blankDateFields()
        #{
        #    this.ProjForecastInvoiceDate        = dateNull();
        #    this.ProjForecastEliminationDate    = dateNull();
        #    this.ProjForecastCostPaymDate       = dateNull();
        #    this.ProjForecastSalesPaymDate      = dateNull();
        #}
      ENDSOURCE
      SOURCE #calcGrossAmount
        #Amount calcGrossAmount(Qty    qty   = this.SalesQty)
        #{
        #    return this.SalesPurchLine::calcGrossAmount(qty);
        #}
        #
      ENDSOURCE
      SOURCE #calcLineAmount
        #Amount calcLineAmount(Qty    qty   = this.SalesQty)
        #{
        #    return this.SalesPurchLine::calcLineAmount(qty);
        #}
      ENDSOURCE
      SOURCE #calcLineDisc
        #DiscAmount calcLineDisc(Qty    qty   = realMin())
        #{
        #    return this.SalesPurchLine::calcLineDisc(qty);
        #}
      ENDSOURCE
      SOURCE #calcPrice2LineAmount
        #AmountCur  calcPrice2LineAmount(Qty _qty, boolean _forceLineAmountCalculation)
        #{
        #    return this.SalesPurchLine::calcPrice2LineAmount(_qty, _forceLineAmountCalculation);
        #}
      ENDSOURCE
      SOURCE #calcQtyOrdered
        #InventQty   calcQtyOrdered(Qty    salesQty  = this.SalesQty)
        #{
        #    return this.SalesPurchLine::calcQtyOrdered(salesQty);
        #}
      ENDSOURCE
      SOURCE #canEditDisc
        #// This method is called when setting disc fields
        #boolean canEditDisc()
        #{
        #    return true;
        #}
      ENDSOURCE
      SOURCE #checkActivity
        #private boolean checkActivity()
        #{
        #    if (this.ActivityNumber && ! ProjActivity::find(this.ActivityNumber))
        #        return checkFailed(strFmt("@SYS50966",this.ActivityNumber));
        #
        #    return true;
        #}
      ENDSOURCE
      SOURCE #checkColor
        #server boolean checkColor()
        #{
        #    if (this.ItemId)
        #    {
        #        if (this.inventTable().colorActive())
        #        {
        #            if (InventDim::find(this.InventDimId).InventColorId)
        #            {
        #                return InventTable::checkColor(this.ItemId,InventDim::find(this.InventDimId).InventColorId);
        #            }
        #            else
        #            {
        #                if (! this.ItemAllocateId)
        #                {
        #                    return checkFailed(strFmt("@SYS73929", EcoResColor::label()));
        #                }
        #            }
        #        }
        #    }
        #    return true;
        #}
      ENDSOURCE
      SOURCE #checkConfig
        #server boolean checkConfig()
        #{
        #    if (this.ItemId)
        #    {
        #        if (this.inventTable().configActive())
        #        {
        #            if (InventDim::find(this.InventDimId).ConfigId)
        #            {
        #                return InventTable::checkConfig(this.ItemId,InventDim::find(this.InventDimId).ConfigId);
        #            }
        #            else
        #            {
        #                if (! this.ItemAllocateId)
        #                {
        #                    return checkFailed("@SYS26797");
        #                }
        #            }
        #        }
        #    }
        #    return true;
        #}
      ENDSOURCE
      SOURCE #checkInventDimCombination
        #/// <summary>
        #/// Validates that the inventory dimension combination is correct.
        #/// </summary>
        #/// <returns>
        #/// true if the combination is correct; otherwise, false.
        #/// </returns>
        #public boolean checkInventDimCombination()
        #{
        #    if (this.ItemId)
        #    {
        #        return this.inventDim().validateWriteInventDimCombination(this.ItemId);
        #    }
        #    return true;
        #}
      ENDSOURCE
      SOURCE #checkInventStatus
        #/// <summary>
        #///    Determines if the specified inventory status dimension value is valid.
        #/// </summary>
        #/// <returns>
        #///    true if the specified inventory status dimension value is valid; otherwise, false.
        #/// </returns>
        #public server boolean checkInventStatus()
        #{
        #    return WHSInventStatus::allowCreateForecast(this.inventDim().InventStatusId);
        #}
      ENDSOURCE
      SOURCE #checkModel
        #boolean checkModel()
        #{
        #    return ForecastModel::checkModel(this.ModelId);
        #}
      ENDSOURCE
      SOURCE #checkProductDim
        #/// <summary>
        #/// Checks all the product dimensions.
        #/// </summary>
        #/// <returns>
        #/// true if the product dimensions are correct; otherwise, false.
        #/// </returns>
        #server boolean checkProductDim()
        #{
        #    #InventDimDevelop
        #    boolean ok;
        #
        #    ok =       this.checkConfig();
        #    ok = ok && this.checkSize();
        #    ok = ok && this.checkColor();
        #    ok = ok && this.checkStyle();
        #    ok = ok && this.checkInventDimCombination();
        #
        #    return ok;
        #}
      ENDSOURCE
      SOURCE #checkProject
        #boolean checkProject()
        #{
        #    ProjValCheckTrans   projValCheckTrans   = new ProjValCheckTrans();
        #    boolean             ret = true;
        #    ForecastModel       forecastModel;
        #
        #    if (this.ProjId)
        #    {
        #        ret = ProjTable::find(this.ProjId).status().validateWriteBudgetItem()   && ret;
        #        ret = ProjForecastPost::newPostForecastItem(this).runCheck() && ret;
        #
        #        if (this.ProjId)
        #            ret  = projValCheckTrans.validateMandatory(this) && ret;
        #
        #        if (this.ProjForecastInvoiceDate != dateNull())
        #        {
        #            if (this.ProjForecastInvoiceDate < this.StartDate)
        #            {
        #                ret = checkFailed("@SYS96098") && ret;
        #            }
        #        }
        #        if (this.ProjForecastEliminationDate != dateNull())
        #        {
        #            if (this.ModelId)
        #            {
        #                forecastModel = ForecastModel::find(HeadingSub::Heading,this.ModelId);
        #                if (forecastModel)
        #                {
        #                    //Check WIP is being used by model
        #                    switch (ProjTable::find(this.ProjId).Type)
        #                    {
        #                        case ProjType::FixedPrice :
        #                            if (forecastModel.ProjForecastWIPFixedPrice)
        #                            {
        #                                if (this.ProjForecastEliminationDate < this.StartDate)
        #                                {
        #                                ret = checkFailed("@SYS96097") && ret;
        #                                }
        #                            }
        #                            break;
        #
        #                        case ProjType::TimeMaterial :
        #                            if (forecastModel.ProjForecastWIPTimeMaterial)
        #                            {
        #                                if (this.ProjForecastEliminationDate < this.StartDate)
        #                                {
        #                                ret = checkFailed("@SYS96097") && ret;
        #                                }
        #                            }
        #                            break;
        #
        #                        case ProjType::Investment :
        #                            if (forecastModel.ProjForecastWIPInvestment)
        #                            {
        #                                if (this.ProjForecastEliminationDate < this.StartDate)
        #                                {
        #                                ret = checkFailed("@SYS96097") && ret;
        #                                }
        #                            }
        #                            break;
        #
        #                        default :
        #                    }
        #                }
        #            }
        #        }
        #    }
        #
        #    return ret;
        #}
      ENDSOURCE
      SOURCE #checkReqActivity
        #public boolean checkReqActivity(ForecastSales   forecastSales)
        #{
        #    RequireActivity             requireActivity;
        #    boolean                     ret = true;
        #    ;
        #
        #    requireActivity = ProjTable::checkRequireActivity(forecastSales.ProjId,tableNum(ForecastSales));
        #    if (requireActivity && (!forecastSales.ActivityNumber))
        #    {
        #        ret = false;
        #    }
        #    return ret;
        #}
        #
      ENDSOURCE
      SOURCE #checkSize
        #server boolean checkSize()
        #{
        #    if (this.ItemId)
        #    {
        #        if (this.inventTable().sizeActive())
        #        {
        #            if (InventDim::find(this.InventDimId).InventSizeId)
        #            {
        #                return InventTable::checkSize(this.ItemId,InventDim::find(this.InventDimId).InventSizeId);
        #            }
        #            else
        #            {
        #                if (! this.ItemAllocateId)
        #                {
        #                    return checkFailed(strFmt("@SYS73929", EcoResSize::label()));
        #                }
        #            }
        #        }
        #    }
        #    return true;
        #}
      ENDSOURCE
      SOURCE #checkStyle
        #/// <summary>
        #/// Indicates whether the style dimension value is specified.
        #/// </summary>
        #/// <returns>
        #/// true if the style dimension value is specified; otherwise, false.
        #/// </returns>
        #public server boolean checkStyle()
        #{
        #    if (this.ItemId)
        #    {
        #        if (this.inventTable().styleActive())
        #        {
        #            if (InventDim::find(this.InventDimId).InventStyleId)
        #            {
        #                return InventTable::checkStyle(this.ItemId,InventDim::find(this.InventDimId).InventStyleId);
        #            }
        #            else
        #            {
        #                if (! this.ItemAllocateId)
        #                {
        #                    return checkFailed(strFmt("@SYS73929", EcoResStyle::label()));
        #                }
        #            }
        #        }
        #    }
        #    return true;
        #}
      ENDSOURCE
      SOURCE #clearingPeriod
        #ClearingPeriod clearingPeriod()
        #{
        #    CustTable       custTable;
        #    CustGroup       custGroup;
        #
        #    if (this.CustAccountId)
        #    {
        #        custTable= this.custTable();
        #
        #        return custTable.clearingPeriod();
        #    }
        #
        #    if (this.CustGroupId)
        #    {
        #        custGroup = this.custGroup();
        #
        #        return custGroup.clearingPeriod();
        #    }
        #
        #    return CustParameters::find().Due2Payment;
        #}
      ENDSOURCE
      SOURCE #companyInfo
        #/// <summary>
        #/// Retrieves the <c>CompanyInfo</c> record associated with the current record.
        #/// </summary>
        #/// <returns>
        #/// The <c>CompanyInfo</c> record.
        #/// </returns>
        #public CompanyInfo companyInfo()
        #{
        #    return CompanyInfo::findDataArea(this.company());
        #}
      ENDSOURCE
      SOURCE #contributionMarginMST
        #ContributionMargin contributionMarginMST()
        #{
        #    return this.BudgetMap::amountMST() - this.costValue();
        #}
      ENDSOURCE
      SOURCE #copyDimension
        #/// <summary>
        #/// Retrieves a dimension set that can be applied to the <c>defaultDimension</c> field on this table.
        #/// </summary>
        #/// <param name="_defaultDimension">
        #/// A dimension set to apply to the <c>defaultDimension</c> field on this table.
        #/// </param>
        #/// <param name="_dimensionCopy">
        #/// A <c>dimensionCopy</c> object that was previously instantiated by using the current buffer;
        #/// optional.
        #/// </param>
        #/// <returns>
        #/// A dimension set that can be applied to the <c>defaultDimension</c> field on this table.
        #/// </returns>
        #/// <remarks>
        #/// This method makes sure that potential linked dimensions are not overwritten.
        #/// </remarks>
        #
        #public DimensionDefault copyDimension(
        #    DimensionDefault _defaultDimension,
        #    DimensionCopy    _dimensionCopy = DimensionCopy::newFromTable(this, CompanyInfo::findDataArea(curext()).RecId)
        #    )
        #{
        #    return _dimensionCopy.copy(_defaultDimension);
        #}
      ENDSOURCE
      SOURCE #costAmount
        #/// <summary>
        #/// It does the unit conversion from SalesQty unit to InventQty unit. Then calculate final cost amount by multiplying the InventQty unit with cost price.
        #/// </summary>
        #/// <returns>
        #/// Returns the final cost amount.
        #/// </returns>
        #display ProjCostAmount costAmount()
        #{
        #    return UnitOfMeasureConverter::convert(
        #           this.SalesQty,
        #           UnitOfMeasure::unitOfMeasureIdBySymbol(this.SalesUnitId),
        #           UnitOfMeasure::unitOfMeasureIdBySymbol(this.inventTable().inventUnitId()),
        #           NoYes::Yes,
        #           InventTable::itemProduct(this.ItemId)) * this.CostPrice;
        #}
      ENDSOURCE
      SOURCE #costValue
        #public CostAmount costValue()
        #{
        #    return this.CostPrice * this.InventQty;
        #}
      ENDSOURCE
      SOURCE #custGroup
        #CustGroup custGroup()
        #{
        #    return CustGroup::find(this.CustGroupId);
        #}
      ENDSOURCE
      SOURCE #custTable
        #CustTable custTable()
        #{
        #    return CustTable::find(this.CustAccountId);
        #}
      ENDSOURCE
      SOURCE #defBudget
        #ForecastSales defBudget()
        #{
        #    ForecastSales forecastSales;
        #
        #    return forecastSales;
        #}
      ENDSOURCE
      SOURCE #delete
        #void delete(NoYes deleteExpand= NoYes::Yes)
        #{
        #    ttsbegin;
        #
        #    this.BudgetMap::delete(deleteExpand);
        #
        #    ttscommit;
        #}
      ENDSOURCE
      SOURCE #derived
        #//BP Deviation documented
        #display ForecastDerived derived()
        #{
        #    return (this.ExpandId ? true : false);
        #}
      ENDSOURCE
      SOURCE #discAmount
        #DiscAmount discAmount()
        #{
        #    return this.DiscAmount;
        #}
      ENDSOURCE
      SOURCE #discPercent
        #DiscPct  discPercent()
        #{
        #    return this.DiscPercent;
        #}
      ENDSOURCE
      SOURCE #forecastModel
        #ForecastModel forecastModel()
        #{
        #    return ForecastModel::find(HeadingSub::Heading,this.ModelId);
        #}
      ENDSOURCE
      SOURCE #grossAmount
        #//BP Deviation documented
        #edit ForecastGrossAmount grossAmount(
        #    boolean     set         = false,
        #    AmountCur   grossAmount = 0)
        #{
        #    return this.SalesPurchLine::grossAmount(set,grossAmount);
        #}
      ENDSOURCE
      SOURCE #inclTax
        #boolean inclTax()
        #{;
        #    return this.SalesPurchLine::inclTax();
        #}
      ENDSOURCE
      SOURCE #initFromCustGroup
        #void initFromCustGroup()
        #{
        #    CustGroup custGroup = CustGroup::find(this.CustGroupId);
        #
        #    if (! custGroup)
        #        return;
        #
        #    if (this.CustGroupId != CustTable::find(this.CustAccountId).CustGroup)
        #        this.CustAccountId = '';
        #
        #    this.Comment    = custGroup.Name;
        #}
      ENDSOURCE
      SOURCE #initFromCustTable
        #void initFromCustTable()
        #{
        #    CustTable custTable= this.custTable();
        #
        #    if (! custTable)
        #        return;
        #
        #    this.CustGroupId    = custTable.CustGroup;
        #    this.TaxGroupId     = custTable.TaxGroup;
        #    this.Comment        = custTable.name();
        #    this.Currency       = custTable.Currency;
        #    this.DefaultDimension = this.mergeDimension(custTable.DefaultDimension, InventTable::find(this.ItemId).DefaultDimension);
        #}
        #
      ENDSOURCE
      SOURCE #initFromForecastModel
        #void initFromForecastModel()
        #{
        #    ForecastModel   forecastModel = ForecastModel::find(HeadingSub::Heading,this.ModelId);
        #
        #    if (! forecastModel)
        #        return;
        #
        #    this.Cov          = forecastModel.Cov;
        #}
      ENDSOURCE
      SOURCE #initFromInventTable
        #void initFromInventTable()
        #{
        #    InventTable         inventTable         = InventTable::find(this.ItemId);
        #    InventTableModule   inventTableModule   = this.inventTableModule();
        #    InventDim           inventDim;
        #    ProjTable           projTable           = ProjTable::find(this.ProjId);
        #
        #    if (!inventTable)
        #    {
        #        return;
        #    }
        #
        #    this.ItemGroupId        = inventTable.itemGroupId();
        #    this.SalesUnitId        = inventTableModule.UnitId;
        #    this.TaxItemGroupId     = inventTableModule.TaxItemGroupId;
        #    this.Comment            = inventTable.defaultProductName();
        #    this.ProjCategoryId     = inventTable.ProjCategoryId;
        #
        #    this.DefaultDimension  = this.copyDimension(projTable.DefaultDimension);
        #
        #    this.DefaultDimension = this.mergeDimension(this.DefaultDimension, CustTable::find(this.CustAccountId).DefaultDimension);
        #    this.DefaultDimension = this.mergeDimension(this.DefaultDimension, inventTable.DefaultDimension);
        #
        #    if (this.InventDimId)
        #    {
        #        inventDim = InventDim::find(this.InventDimId);
        #    }
        #
        #    #InventDimDevelop
        #
        #    inventDim.initFromInventTable(inventTable, InventItemOrderSetupType::Invent, inventDim);//WPA//Upgrade
        #
        #    inventDim = InventDim::findOrCreate(inventDim);
        #    this.setInventDimId(inventDim.InventDimId, inventDim);
        #
        #    this.CostPrice = inventTable.costPcsPrice(this.InventDimId, inventDim, null, this.StartDate);
        #}
      ENDSOURCE
      SOURCE #initFromItemGroup
        #void initFromItemGroup()
        #{
        #    InventItemGroup itemGroup   = InventItemGroup::find(this.ItemGroupId);
        #
        #    if (! itemGroup)
        #        return;
        #
        #    if (this.ItemGroupId != InventTable::find(this.ItemId).itemGroupId())
        #    {
        #        this.ItemId = '';
        #    }
        #
        #    this.ItemAllocateId = itemGroup.StandardItemAllocateId;
        #    this.Comment        = itemGroup.Name;
        #}
      ENDSOURCE
      SOURCE #initFromPriceDisc
        #server void initFromPriceDisc(PriceDisc_Price priceDisc, PriceDiscPolicyCheckPolicy _checkPolicy = null, boolean _initDateFields = true)
        #{
        #    this.SalesPrice         = priceDisc.price();
        #    this.PriceUnit          = priceDisc.priceUnit();
        #    this.SalesMarkup        = priceDisc.priceMarkup();
        #}
      ENDSOURCE
      SOURCE #initFromProjActivity
        #/// /// <summary>
        #///    Initializes the category of the journal line with the default category of the project activity passed in as a parameter.
        #/// </summary>
        #/// <param name="_projActivity">
        #///    The project activity used to initialize the category of the journal line.
        #/// </param>
        #public void initFromProjActivity(ProjActivity _projActivity)
        #{
        #    if (!_projActivity || !_projActivity.CategoryDefault ||
        #            ProjCategory::find(_projActivity.CategoryDefault).CategoryType != ProjCategoryType::Item)
        #    {
        #        return;
        #    }
        #
        #    this.ProjCategoryId = _projActivity.CategoryDefault;
        #}
      ENDSOURCE
      SOURCE #initFromProjInvoiceDate
        #void initFromProjInvoiceDate()
        #{
        #    PaymTermId          paymentTermsID;
        #    ProjFundingSource    projFundingSource;
        #    ProjTable           projTable       = this.projTable();
        #    ProjParameters      projParameters  = ProjParameters::find();
        #
        #    // sales payment date
        #    if (projTable && projTable.Type   == ProjType::TimeMaterial)
        #    {
        #        if (this.ProjFundingSource)
        #        {
        #            paymentTermsID = ProjFundingSource::find(this.ProjFundingSource).PaymentTermsId;
        #        }
        #        else
        #        {
        #            if (ProjFundingSource::numberOfFundingSources(projTable.ProjInvoiceProjId) == 1)
        #            {
        #                select PaymentTermsId from projFundingSource
        #                    where projFundingSource.ContractId == projTable.ProjInvoiceProjId &&
        #                          projFundingSource.FundingType == ProjFundingType::Customer;
        #
        #                paymentTermsID = projFundingSource.PaymentTermsId;
        #            }
        #        }
        #
        #        if (paymentTermsID)
        #        {
        #            this.ProjForecastSalesPaymDate = PaymTerm::advanceDate(paymentTermsID, this.ProjForecastInvoiceDate) + projParameters.ForecastBufferDays;
        #        }
        #        else
        #        {
        #            this.ProjForecastSalesPaymDate  = this.ProjForecastInvoiceDate+ projParameters.ForecastBufferDays;
        #        }
        #    }
        #}
        #
      ENDSOURCE
      SOURCE #initFromProjTable
        #void initFromProjTable(ProjTable   projTable)
        #{
        #    InventDim inventDim;
        #    InventTable         inventTable         = InventTable::find(this.ItemId);
        #
        #    if (!projTable)
        #    {
        #        return;
        #    }
        #
        #    this.ProjId                 = projTable.ProjId;
        #    this.CustAccountId          = projTable.CustAccount;
        #    this.initFromCustTable();
        #
        #    this.TaxGroupId             = projTable.TaxGroupId;
        #    this.Comment                = projTable.Name;
        #    this.Currency               = projTable.currencyId();
        #
        #    this.SalesPrice = 0;
        #    this.SalesMarkup= 0;
        #    this.SalesPurchLine::setPriceAgreement(inventDim);
        #
        #    if (!this.ModelId)
        #    {
        #        this.ModelId                = ProjTable::modelId(this.ProjId);
        #        this.initFromForecastModel();
        #    }
        #
        #    this.DefaultDimension  = this.copyDimension(projTable.DefaultDimension);
        #
        #    this.DefaultDimension = this.mergeDimension(this.DefaultDimension, CustTable::find(this.CustAccountId).DefaultDimension);
        #    this.DefaultDimension = this.mergeDimension(this.DefaultDimension, inventTable.DefaultDimension);
        #
        #    if (!ProjValProjCategorySetUp::checkProjCategory(this.ProjId,this.ProjCategoryId))
        #    {
        #        this.ProjCategoryId = '';
        #    }
        #
        #    this.ProjLinePropertyId     = ProjLinePropertySetup::findLinePropertyId(this.ProjId, this.ProjCategoryId);
        #    this.StartDate              = projTable.returnForecastDate();
        #    this.initFromTransDate();
        #}
        #
      ENDSOURCE
      SOURCE #initFromSalesQuotationLine
        #void initFromSalesQuotationLine(SalesQuotationLine      _salesQuotationLine)
        #{
        #    InventTableModule       inventTableModule;
        #    InventPriceMarkup       inventPriceMarkup;
        #    InventQty               transQty;
        #
        #    this.ProjId             = _salesQuotationLine.salesQuotationTable().ProjIdRef;
        #    this.initFromProjTable(ProjTable::find(this.ProjId));
        #
        #    this.Active             = NoYes::Yes;
        #
        #    this.ModelId            = _salesQuotationLine.salesQuotationTable().ModelId;
        #
        #    if (_salesQuotationLine.ItemId)
        #    {
        #        this.ItemId             = _salesQuotationLine.ItemId;
        #        this.initFromInventTable();
        #    }
        #    else
        #    {
        #        this.ItemAllocateId     = ProjParameters::find().DefaultForecastItemAllocation;
        #        if (!this.ItemAllocateId)
        #        {
        #            throw error ("@SYS334837");
        #        }
        #
        #        this.TaxGroupId         = _salesQuotationLine.TaxGroup;
        #        this.SalesUnitId        = _salesQuotationLine.SalesUnit;
        #        this.TaxItemGroupId     = _salesQuotationLine.TaxItemGroup;
        #        this.Comment            = '';
        #    }
        #
        #    this.setInventDimId(_salesQuotationLine.InventDimId);
        #    this.ProjCategoryId     = _salesQuotationLine.ProjCategoryId;
        #    this.ProjLinePropertyId = _salesQuotationLine.LinePropertyId;
        #
        #    this.InventQty          = _salesQuotationLine.SalesQty;
        #    this.SalesQty           = _salesQuotationLine.SalesQty;
        #
        #    this.DefaultDimension  = this.copyDimension(_salesQuotationLine.DefaultDimension);
        #
        #    this.StartDate          = _salesQuotationLine.TransDate ? _salesQuotationLine.TransDate : systemDateGet();
        #    this.EndDate            = _salesQuotationLine.EndDate;
        #
        #    if (_salesQuotationLine.isStocked())
        #    {
        #        inventTableModule   = InventTableModule::find(_salesQuotationLine.ItemId, ModuleInventPurchSales::Invent);
        #        inventPriceMarkup   = inventTableModule.AllocateMarkup ? 0 : inventTableModule.Markup * sign(this.InventQty);
        #        transQty            = _salesQuotationLine.QtyOrdered;
        #
        #        if (!transQty)
        #        {
        #            transQty = this.InventQty;
        #        }
        #        this.CostPrice      = (_salesQuotationLine.CostPrice + inventPriceMarkup / transQty) * this.InventQty;
        #    }
        #
        #    this.Currency           = _salesQuotationLine.CurrencyCode;
        #    this.PriceUnit          = _salesQuotationLine.PriceUnit;
        #
        #    this.initFromTransDate();
        #    if(!_salesQuotationLine.SalesPrice && _salesQuotationLine.LineAmount && _salesQuotationLine.SalesQty)
        #    this.SalesPrice     = _salesQuotationLine.LineAmount / _salesQuotationLine.SalesQty;
        #    else
        #    this.SalesPrice     = _salesQuotationLine.SalesPrice;
        #
        #    this.Amount         = _salesQuotationLine.LineAmount;
        #
        #    //BOM/route
        #    this.ItemBOMId      = _salesQuotationLine.ItemBOMId;
        #    this.ItemRouteId    = _salesQuotationLine.ItemRouteId;
        #
        #}
        #
      ENDSOURCE
      SOURCE #initFromTransDate
        #void initFromTransDate(boolean _calledFromAOS = false)
        #{
        #    ProjTable       projTable       = this.projTable();
        #    ProjParameters  projParameters  = ProjParameters::find();
        #
        #    //  invoice date
        #    if (projTable.Type == ProjType::TimeMaterial)
        #    {
        #        if (projTable.projInvoice().ForecastInvoiceFrequency)
        #        {
        #            this.ProjForecastInvoiceDate    = ProjInvoiceTable::forecastInvoiceDate(this.StartDate,this.ProjId, _calledFromAOS);
        #        }
        #        else
        #        {
        #            this.ProjForecastInvoiceDate    = this.StartDate;
        #        }
        #    }
        #    else if (projTable.Type == ProjType::FixedPrice || projTable.Type == ProjType::Investment)
        #    {
        #        // Project forecast invoice date is not used for Fixed price or Investment projects
        #        this.ProjForecastInvoiceDate = dateNull();
        #    }
        #
        #    this.initFromProjInvoiceDate();
        #
        #    //  elimination date
        #    if (projTable.Type == ProjType::FixedPrice || projTable.Type == ProjType::Investment)
        #    {
        #        if (ProjTable::exist(projTable.wipProject))
        #        {
        #            this.ProjForecastEliminationDate = ProjTable::find(projTable.wipProject).EndDate;
        #        }
        #        else
        #        {
        #            this.ProjForecastEliminationDate = projTable.EndDate;
        #        }
        #
        #        if (!this.ProjForecastEliminationDate)
        #        {
        #            this.ProjForecastEliminationDate = this.StartDate;
        #        }
        #    }
        #
        #    // cost payment date
        #    if (projTable.Type   != ProjType::Time)
        #    {
        #        if (projParameters.ForecastPaymItem)
        #        {
        #            this.ProjForecastCostPaymDate = PaymTerm::advanceDate(projParameters.ForecastPaymItem,this.StartDate, _calledFromAOS);
        #        }
        #        else
        #        {
        #            this.ProjForecastCostPaymDate   = this.StartDate;
        #        }
        #    }
        #
        #}
        #
      ENDSOURCE
      SOURCE #initValue
        #void initValue()
        #{
        #    this.BudgetMap::initValue();
        #
        #    this.initFromInventTable();
        #    this.initFromItemGroup();
        #    this.initFromCustTable();
        #    this.initFromCustGroup();
        #}
      ENDSOURCE
      SOURCE #insert
        #void insert()
        #{
        #    NumberSeq           numberSeq;
        #
        #    ttsbegin;
        #
        #    if (this.ProjId && ! this.ProjTransId)
        #    {
        #        numberSeq = NumberSeq::newGetNum(ProjParameters::numRefProjTransIdBase());
        #        this.ProjTransId = numberSeq.num();
        #    }
        #
        #    this.BudgetMap::insert();
        #
        #    if (this.ProjId)
        #        ProjForecastPost::newPostForecastItem(this).run();
        #
        #    ttscommit;
        #}
      ENDSOURCE
      SOURCE #inventDim
        #InventDim inventDim(boolean _forUpdate = false)
        #{
        #    return InventDim::find(this.InventDimId,_forUpdate);
        #}
      ENDSOURCE
      SOURCE #inventProfileType_RU
        #InventProfileType_RU inventProfileType_RU()
        #{
        #    InventProfileType_RU inventProfileType;
        #    ;
        #    inventProfileType = this.inventDim().inventProfile_RU().InventProfileType;
        #    if (inventProfileType == InventProfileType_RU::NotSpecified)
        #    {
        #        inventProfileType = InventProfileType_RU::General;
        #    }
        #    return inventProfileType;
        #}
      ENDSOURCE
      SOURCE #inventTable
        #InventTable inventTable()
        #{
        #    return InventTable::find(this.ItemId);
        #}
      ENDSOURCE
      SOURCE #inventTableModule
        #InventTableModule inventTableModule()
        #{
        #    return InventTableModule::find(this.ItemId,ModuleInventPurchSales::Sales);
        #}
      ENDSOURCE
      SOURCE #invoiceAccount
        #CustAccount invoiceAccount()
        #{
        #    return this.custTable().InvoiceAccount ? this.custTable().InvoiceAccount : this.CustAccountId;
        #}
      ENDSOURCE
      SOURCE #isCategoryBased
        #/// <summary>
        #/// Checks whether the order line is category-based.
        #/// </summary>
        #/// <returns>
        #/// Always returns false.
        #/// </returns>
        #/// <remarks>
        #/// Category does not apply for forecast lines.
        #/// </remarks>
        #boolean isCategoryBased()
        #{
        #    return false;
        #}
      ENDSOURCE
      SOURCE #isProjForecastReduced
        #private boolean isProjForecastReduced()
        #{
        #    return ProjForecastReductionHistory::existProjForecastTransId(this.ProjTransId);
        #}
      ENDSOURCE
      SOURCE #isProjLumpSum
        #boolean isProjLumpSum()
        #{
        #    ProjParameters      projParameters=ProjParameters::find(false);
        #
        #    ;
        #
        #    if (this.ProjId && this.ItemAllocateId && this.ItemAllocateId == projParameters.ItemLumpSumAllocationKey)
        #        return true;
        #
        #    return false;
        #}
      ENDSOURCE
      SOURCE #itemIdSmall
        #// AOSRunMode::Called
        #//BP Deviation documented
        #edit ItemIdSmall itemIdSmall(boolean         set,
        #                             ForecastSales   _forecastSales,
        #                             ItemIdSmall    _itemId)
        #{
        #    if (set)
        #        _forecastSales.ItemId    = _itemId;
        #
        #    return _forecastSales.ItemId;
        #}
        #
      ENDSOURCE
      SOURCE #itemLineDisc
        #LineDiscCode itemLineDisc()
        #{
        #    return this.inventTable().salesLineDisc();
        #}
      ENDSOURCE
      SOURCE #itemName
        #//BP Deviation documented
        #display ItemName itemName()
        #{
        #    return InventTable::find(this.ItemId).itemName(this.inventDim());
        #}
      ENDSOURCE
      SOURCE #lineDisc
        #LineDiscCode lineDisc()
        #{;
        #    return this.custTable().LineDisc;
        #}
      ENDSOURCE
      SOURCE #linkInventDim2Dimension
        #/// <summary>
        #///    Provides default <c>ForecastSales.dimension</c> values, depending on the <c>InventDim</c> record
        #///    buffer values.
        #/// </summary>
        #/// <param name="_newInventDim">
        #///    The <c>InventDim</c> record buffer linked to the current <c>ForecastSales</c> record buffer.
        #/// </param>
        #/// <param name="_oldInventDim">
        #///    The <c>InventDim</c> record buffer that was previously linked to the current <c>ForecastSales</c>
        #///    record buffer.
        #/// </param>
        #public void linkInventDim2Dimension(InventDim _newInventDim, InventDim _oldInventDim)
        #{
        #    ;
        #    _newInventDim.setInventSiteFromParentIfModified(this, _oldInventDim);
        #}
      ENDSOURCE
      SOURCE #mergeDimension
        #/// <summary>
        #/// Retrieves a dimension set that holds the merged combination of the current <c>defaultDimension</c>
        #/// field on this table and the specified dimension set.
        #/// </summary>
        #/// <param name="_primaryDefaultDimension">
        #/// A first dimension set to merge with the current <c>defaultDimension</c> field on this table.
        #/// </param>
        #/// <param name="_secondaryDefaultDimension">
        #/// A second dimension set to merge with the current <c>defaultDimension</c> field on this table;
        #/// optional.
        #/// </param>
        #/// <param name="_dimensionMerge">
        #/// A <c>dimensionMerge</c> object that was initialized with the current buffer; optional.
        #/// </param>
        #/// <returns>
        #/// A dimension set that holds the merged combination of the current <c>defaultDimension</c> field on
        #/// this table and the specified dimension set.
        #/// </returns>
        #/// <remarks>
        #/// This method makes sure that potential linked dimensions are not overwritten when they are merged.
        #/// </remarks>
        #
        #public DimensionDefault mergeDimension(
        #    DimensionDefault _primaryDefaultDimension,
        #    DimensionDefault _secondaryDefaultDimension = 0,
        #    DimensionMerge   _dimensionMerge = DimensionMerge::newFromTable(this,
        #                                                                    this.companyInfo().RecId
        #                                                                    )
        #    )
        #{
        #    return _dimensionMerge.merge(_primaryDefaultDimension, _secondaryDefaultDimension);
        #}
      ENDSOURCE
      SOURCE #modifiedField
        #public void modifiedField(FieldId _fieldId)
        #{
        #    InventDim inventDim;
        #    super(_fieldId);
        #
        #    switch (_fieldId)
        #    {
        #        case fieldNum(ForecastSales, ProjCategoryId):
        #            this.ProjLinePropertyId = ProjLinePropertySetup::findLinePropertyId(this.ProjId,this.ProjCategoryId);
        #            break;
        #
        #        case fieldNum(ForecastSales, ProjId):
        #            this.initFromProjTable(ProjTable::find(this.ProjId));
        #            // blank and reinitialize the Project Forecast date fields
        #            this.blankDateFields();
        #            if (this.ProjId)
        #            {
        #                this.initFromTransDate();
        #            }
        #            break;
        #
        #        case fieldNum(ForecastSales, AllocateMethod):
        #            this.BudgetMap::setAfterAllocateMethod();
        #            break;
        #
        #        case fieldNum(ForecastSales, ModelId):
        #            this.initFromForecastModel();
        #            break;
        #
        #        case fieldNum(ForecastSales, Amount):
        #            this.SalesPurchLine::lineAmountModified();
        #            break;
        #
        #        case fieldNum(ForecastSales, SalesUnitId):
        #        case fieldNum(ForecastSales, SalesQty):
        #            this.InventQty  = this.calcQtyOrdered();
        #            break;
        #
        #        case fieldNum(ForecastSales, Currency):
        #            this.SalesPrice = 0;
        #            this.SalesMarkup= 0;
        #            break;
        #
        #        case fieldNum(ForecastSales, CustAccountId):
        #            this.initFromCustTable();
        #            break;
        #
        #        case fieldNum(ForecastSales, ItemGroupId):
        #            this.initFromItemGroup();
        #            break;
        #
        #        case fieldNum(ForecastSales, CustGroupId):
        #            this.initFromCustGroup();
        #            break;
        #
        #        case fieldNum(ForecastSales, StartDate):
        #            this.SalesPurchLine::setPriceAgreement(inventDim);
        #            if (this.ProjId)
        #                this.initFromTransDate();
        #            break;
        #
        #        case fieldNum(ForecastSales, ProjForecastInvoiceDate):
        #            this.initFromProjInvoiceDate();
        #            break;
        #
        #        case fieldNum(ForecastSales, ItemId):
        #            if(!this.isProjLumpSum())
        #            {
        #                this.initFromInventTable();
        #            }
        #            break;
        #    }
        #}
      ENDSOURCE
      SOURCE #modifiedProductDim
        #/// <summary>
        #/// Sets the price and discount by using the agreements, if it is required.
        #/// </summary>
        #/// <param name="_inventDim">
        #/// An <c>InventDim</c> record to use to find price agreements.
        #/// </param>
        #/// <param name="_dimFieldId">
        #/// A <c>fieldId</c> value of an <c>InventDim</c> field to use to determine whether price agreements
        #/// must be used.
        #/// </param>
        #/// <param name="_inventDimGroupSetup">
        #/// An instance of the <c>InventDimGroupSetup</c> class that provides information about dimension setup.
        #/// </param>
        #/// <returns>
        #/// true if the line was updated; otherwise, false.
        #/// </returns>
        #public boolean modifiedProductDim(
        #    InventDim                           _inventDim,
        #    FieldId                             _dimFieldId,
        #    InventDimGroupSetup                 _inventDimGroupSetup)
        #{
        #    if (InventDim::mustUseFieldSalesPriceDisc(_dimFieldId, _inventDimGroupSetup))
        #    {
        #        this.SalesPurchLine::setPriceAgreement(_inventDim);
        #        return true;
        #    }
        #    return false;
        #}
      ENDSOURCE
      SOURCE #moduleType
        #ModuleInventPurchSales moduleType()
        #{
        #    return ModuleInventPurchSales::Sales;
        #}
      ENDSOURCE
      SOURCE #mustBeCovPlanned
        #boolean mustBeCovPlanned()
        #{
        #    return this.Report      &&
        #           this.Active      &&
        #           this.Cov         &&
        #           ForecastModel::cov(this.ModelId);
        #
        #}
      ENDSOURCE
      SOURCE #orderAccount
        #CustVendAC orderAccount()
        #{;
        #    return this.CustAccountId;
        #}
      ENDSOURCE
      SOURCE #payment
        #PaymTermId payment()
        #{
        #    PaymTermId  payment;
        #
        #    if (this.CustAccountId)
        #    {
        #        payment  = CustTable::find(this.CustAccountId).PaymTermId;
        #    }
        #
        #    if (! payment  && this.CustGroupId)
        #    {
        #        payment  = CustGroup::find(this.CustGroupId).PaymTermId;
        #    }
        #
        #    if (! payment)
        #    {
        #        payment  = CustParameters::find().Invoice2Due;
        #    }
        #
        #    return payment;
        #}
      ENDSOURCE
      SOURCE #postingProfile_RU
        #CustPostingProfile postingProfile_RU()
        #{
        #    CustPostingProfile          postingProfile;
        #
        #    if (EcoResDimensionGroupSetup::isInventoryDimensionActiveForItem(this.ItemId, fieldNum(InventDim, InventProfileId_RU)))
        #    {
        #         postingProfile = InventProfileCustVendLedger_RU::custPostingProfile(this.inventDim().InventProfileId_RU);
        #    }
        #
        #    if (! postingProfile)
        #    {
        #        postingProfile = CustParameters::find().PostingProfile;
        #    }
        #
        #    return postingProfile;
        #}
      ENDSOURCE
      SOURCE #priceDate
        #/// <summary>
        #/// Retrieves the date for which a price must be calculated.
        #/// </summary>
        #/// <returns>
        #/// The date for which to calculate a price.
        #/// </returns>
        #public PriceDate priceDate()
        #{
        #    return this.StartDate ? this.StartDate : systemDateGet();
        #}
      ENDSOURCE
      SOURCE #priceGroupId
        #PriceGroupId priceGroupId()
        #{
        #    PriceGroupId projPriceGroup;
        #
        #    if (this.ProjId)
        #    {
        #        projPriceGroup = this.projTable().ProjPriceGroup;
        #    }
        #    return projPriceGroup ? projPriceGroup : this.custTable().PriceGroup;
        #}
        #
      ENDSOURCE
      SOURCE #priceUnit
        #PriceUnit priceUnit()
        #{
        #    return this.PriceUnit ? this.PriceUnit : 1;
        #
        #}
      ENDSOURCE
      SOURCE #projCostGroupId
        #ProjCostGroupId projCostGroupId()
        #{
        #    ProjCostGroupId projCostGroupId;
        #
        #    if (this.ProjId)
        #        if (ProjWIPTable::find(this.ProjId).ControlId)
        #            projCostGroupId    = ProjControlCategory::findCategoryGroup(ProjWIPTable::find(this.ProjId).ControlId,this.ProjCategoryId);
        #
        #    return projCostGroupId;
        #
        #}
        #
      ENDSOURCE
      SOURCE #projTable
        #ProjTable projTable()
        #{
        #    return ProjTable::find(this.ProjId);
        #}
        #
      ENDSOURCE
      SOURCE #psAcontribution
        #//BP deviation documented
        #display Amount psAcontribution()
        #{
        #    return this.Amount - this.costValue();
        #}
      ENDSOURCE
      SOURCE #psAdispcostValue
        #// BP Deviation documented
        #display CostAmount psAdispcostValue()
        #{
        #    return this.CostPrice * this.InventQty;
        #}
      ENDSOURCE
      SOURCE #psAeditActivityPurpose
        #public edit smmActivityPurpose psAeditActivityPurpose(boolean _set, ProjActivityNumber _activityNumber)
        #{
        #    smmActivities smmActivities;
        #    str           name;
        #
        #    if (isConfigurationkeyEnabled(configurationKeyNum(Project3)))
        #    {
        #    if (_set)
        #    {
        #        this.ActivityNumber = _activityNumber;
        #        this.initFromProjActivity(ProjActivity::find(_activityNumber));
        #    }
        #    else
        #    {
        #        smmActivities = smmActivities::find(this.ActivityNumber);
        #        name = smmActivities.Purpose;
        #    }
        #    }
        #
        #    return name;
        #}
      ENDSOURCE
      SOURCE #salesAmount
        #//BP Deviation documented
        #display ProjSalesAmount salesAmount()
        #{
        #    return this.SalesQty * this.SalesPrice;
        #}
      ENDSOURCE
      SOURCE #setInventDimId
        #/// <summary>
        #///    Applies the <c>InventDimId</c> parameter to the <c>ForecastSales.inventDimId</c> field and provides
        #///    default values, depending on the new inventory dimensions.
        #/// </summary>
        #/// <param name="_inventDimId">
        #///    The <c>InventDimId</c> value that should be applied to the <c>ForecastSales.InventDimId</c> field.
        #/// </param>
        #/// <param name="_inventDim">
        #///    The <c>InventDim</c> record buffer related to the <c>InventDimId</c> parameters; optional.
        #/// </param>
        #public void setInventDimId(InventDimId _inventDimId, InventDim _inventDim = InventDim::find(_inventDimId))
        #{
        #    InventDim   currentInventDim = this.InventDimId == _inventDimId ? _inventDim : this.inventDim();
        #    ;
        #    this.InventDimId = _inventDimId;
        #    this.linkInventDim2Dimension(_inventDim, currentInventDim);
        #}
      ENDSOURCE
      SOURCE #setInventDimIdFromInventDim
        #/// <summary>
        #///    Finds or creates an <c>InventDimId</c> value for the <c>InventDim</c> parameter and applies the
        #///    found <c>InventDimId</c> value to the <c>ForecastSales.inventDimId</c> field.
        #/// </summary>
        #/// <param name="_inventDim">
        #///    An <c>InventDim</c> record buffer that should be referenced by the current <c>ForecastSales</c>
        #///    record buffer.
        #/// </param>
        #public void setInventDimIdFromInventDim(InventDim _inventDim)
        #{
        #    InventDim   inventDim;
        #    ;
        #    inventDim = InventDim::findOrCreate(_inventDim);
        #    this.setInventDimId(inventDim.InventDimId, inventDim);
        #}
      ENDSOURCE
      SOURCE #update
        #public void update()
        #{
        #    NumberSeq           numberSeq;
        #    FormRun             formRun;
        #    FormObjectSet       formObjSet;
        #    int                 i;
        #    ForecastSales this_Orig = this.orig();
        #    ;
        #
        #    ttsbegin;
        #
        #
        #    if (this.ProjId && ! this.ProjTransId)
        #    {
        #        numberSeq = NumberSeq::newGetNum(ProjParameters::numRefProjTransIdBase());
        #        this.ProjTransId = numberSeq.num();
        #    }
        #
        #    ProjForecastPost::newPostForecastItem(this).deleteTransBudget();
        #
        #    this.BudgetMap::update();
        #
        #    if (this.ProjId)
        #    {
        #        if(ProjParameters::find().ItemDeleteZero
        #        && ((this.isProjLumpSum() && this.CostPrice <=0)
        #           ||(!this.isProjLumpSum() && this.SalesQty <=0)))
        #        {
        #            this.delete();
        #            if (this.isFormDataSource())
        #            {
        #                // refresh and reread forecastSales datasource if exists in form
        #                formRun = this.dataSource().formRun();
        #                for (i=1; i<= formRun.dataSourceCount(); i++)
        #                {
        #                    if (formRun.dataSource(i).cursor().TableId == tableNum(ForecastSales))
        #                    {
        #                        formObjSet = formRun.dataSource(i);
        #                        break;
        #                    }
        #                }
        #                if (formObjSet)
        #                {
        #                    formObjSet.refresh();
        #                    formObjSet.reread();
        #                }
        #            }
        #        }
        #        else
        #            ProjForecastPost::newPostForecastItem(this).run();
        #    }
        #
        #    ttscommit;
        #}
      ENDSOURCE
      SOURCE #updateLedgerCov
        #server void updateLedgerCov()
        #{
        #    LedgerCoverage      cov;
        #    AmountCur           invoiceAmount;
        #    AmountCur           lineValue;
        #    AmountCur           discValue;
        #    AmountMST           costValue;
        #    TaxBudget           taxBudget;
        #    TaxAmountCur        taxAmountCur;
        #    ForecastSales       forecastSalesExpansion;
        #    // <GEERU>
        #    #isoCountryRegionCodes
        #    // </GEERU>
        #
        #    cov = new LedgerCoverage(this);
        #    // <GEERU>
        #    if (SysCountryRegionCode::isLegalEntityInCountryRegion([#isoRU]))
        #    {
        #        cov.parmPostingProfile_RU(this.postingProfile_RU());
        #        cov.parmInventProfileType_RU(this.inventProfileType_RU());
        #    }
        #    // </GEERU>
        #
        #    if (this.mustBeCovPlanned())
        #    {
        #        cov.setRemainPercent(this.StartDate,CustParameters::find().BudgetSettle);
        #
        #        lineValue  = this.calcLineAmount();
        #
        #        if (this.accountDisc())
        #        {
        #            discValue       = this.calcLineDisc(this.SalesQty);
        #            lineValue       = lineValue  + discValue;
        #        }
        #
        #        costValue = Currency::amount(this.InventQty  * this.CostPrice,'');
        #
        #        if (this.TaxGroupId)
        #        {
        #            taxBudget   = new TaxBudget(
        #                NoYes::Yes,
        #                this,
        #                cov);
        #
        #            // pass null because it doesn't actually post to GL
        #            taxAmountCur = taxBudget.calcAndPost(null);
        #        }
        #        else
        #            taxAmountCur = 0;
        #
        #
        #        if (lineValue)
        #        {
        #            cov.updateSum(
        #                this.StartDate,
        #                LedgerPostingType::SalesRevenue,
        #                DimensionStorage::getMainAccountFromLedgerDimension(this.accountSales()).RecId,
        #                this.DefaultDimension,
        #                this.Currency,
        #                -lineValue
        #                );
        #            invoiceAmount -= cov.lastAmount();
        #        }
        #
        #        if (discValue)
        #        {
        #            cov.updateSum(
        #                this.StartDate,
        #                LedgerPostingType::SalesDisc,
        #                DimensionStorage::getMainAccountFromLedgerDimension(this.accountDisc()).RecId,
        #                this.DefaultDimension,
        #                this.Currency,
        #                discValue
        #                );
        #
        #            invoiceAmount -= cov.lastAmount();
        #        }
        #
        #        if (costValue)
        #        {
        #            cov.updateSum(
        #                this.StartDate,
        #                 LedgerPostingType::InventIssue,
        #                 DimensionStorage::getMainAccountFromLedgerDimension(this.accountIssue()).RecId,
        #                 this.DefaultDimension,
        #                 CompanyInfo::standardCurrency(),
        #                 -costValue
        #                 );
        #
        #            cov.updateSum(
        #                this.StartDate,
        #                LedgerPostingType::SalesConsump,
        #                DimensionStorage::getMainAccountFromLedgerDimension(this.accountConsumption()).RecId,
        #                this.DefaultDimension,
        #                CompanyInfo::standardCurrency(),
        #                costValue
        #                );
        #        }
        #
        #        if (invoiceAmount)
        #        {
        #            cov.updateSum(
        #                this.StartDate,
        #                LedgerPostingType::CustBalance,
        #                DimensionStorage::getMainAccountFromLedgerDimension(this.accountCustLedgerDimension()).RecId,
        #                this.DefaultDimension,
        #                this.Currency,
        #                invoiceAmount - taxAmountCur,
        #                0,
        #                DimensionStorage::getMainAccountFromLedgerDimension(this.accountClearingLedgerDimension()).RecId,
        #                this.payment(),
        #                this.clearingPeriod(),
        #                CustTable::find(this.CustAccountId).PaymDayId
        #                );
        #        }
        #    }
        #
        #    cov.endCov();
        #
        #    if (this.BudgetMap::expansion().mustBeExploded())
        #    {
        #        while select forupdate forecastSalesExpansion
        #            where forecastSalesExpansion.ExpandId == this.RecId
        #        {
        #            forecastSalesExpansion.updateLedgerCov();
        #        }
        #    }
        #
        #}
      ENDSOURCE
      SOURCE #validateDelete
        #boolean validateDelete()
        #{
        #    boolean ret;
        #
        #    ret = this.BudgetMap::validateDelete();
        #
        #    return ret;
        #}
      ENDSOURCE
      SOURCE #validateField
        #boolean validateField(FieldId p1)
        #{
        #    ForecastModel   forecastModel;
        #
        #    boolean ret;
        #
        #    ret = super(p1);
        #
        #    switch(p1)
        #    {
        #        case fieldNum(ForecastSales,ProjCategoryId):
        #            if (this.ProjCategoryId)
        #            {
        #                if (ProjCategory::find(this.ProjCategoryId).CategoryType    != ProjCategoryType::Item)
        #                    ret = checkFailed(strFmt("@SYS54897",this.ProjCategoryId));
        #            }
        #            break;
        #        case fieldNum(ForecastSales,ModelId):
        #            if (this.ModelId != this.orig().ModelId)
        #            {
        #                forecastModel  = ForecastModel::find(HeadingSub::Heading,this.orig().ModelId);
        #                if (forecastModel.Blocked)
        #                    ret = checkFailed(strFmt("@SYS25943",forecastModel.ModelId));
        #                else
        #                {
        #                    forecastModel  = ForecastModel::find(HeadingSub::Heading,this.ModelId);
        #                    if (forecastModel.Blocked)
        #                        ret = checkFailed(strFmt("@SYS25943",forecastModel.ModelId));
        #                }
        #
        #            }
        #            break;
        #        case fieldNum(ForecastSales,SalesQty):
        #            if (this.SalesQty < 0)
        #                ret = checkFailed("@SYS50502");
        #            break;
        #
        #        case fieldNum(ForecastSales, ActivityNumber):
        #            ret = this.checkActivity();
        #
        #        break;
        #}
        #
        #    return ret;
        #}
        #
      ENDSOURCE
      SOURCE #validateItemInfo
        #boolean validateItemInfo()
        #{   // Validate item allocation key information etc
        #
        #    if (this.ItemId)
        #    {
        #        if (!InventTable::exist(this.ItemId))
        #            return false; // error message given elsewhere
        #
        #        if (this.ItemAllocateId && !ForecastItemAllocationLine::existItem(this.ItemAllocateId, this.ItemId))
        #            warning(strFmt("@SYS85028", this.ItemAllocateId, this.ItemId));
        #        return true;
        #    }
        #
        #    if (this.ItemGroupId)
        #    {
        #        if (!this.ItemAllocateId)
        #            return checkFailed("@SYS85029");
        #
        #        if (!ForecastItemAllocationLine::existItemGroup(this.ItemAllocateId, this.ItemGroupId))
        #            warning(strFmt("@SYS85031", this.ItemAllocateId, this.ItemGroupId));
        #        return true;
        #    }
        #
        #    if (!this.ItemAllocateId)
        #        return checkFailed("@SYS85030");
        #
        #    return true;
        #}
      ENDSOURCE
      SOURCE #validateWrite
        #server boolean validateWrite()
        #{
        #    boolean ok = true;
        #    boolean isProjForecastReduced;
        #    ;
        #    isProjForecastReduced=this.ProjId!='' && this.isProjForecastReduced();
        #
        #
        #    setPrefix(strFmt("@SYS14077", this.ItemId));
        #
        #    if(this.isProjLumpSum())
        #    {
        #        if( this.SalesQty!=1)
        #            ok = checkFailed("@SYS107838");
        #
        #        if( this.ItemId!='' )
        #            ok = checkFailed("@SYS108570");
        #    }
        #
        #    if(isProjForecastReduced)
        #    {
        #        if(this.orig().ProjId != this.ProjId)
        #            ok= checkFailed(strFmt("@SYS113137",fieldStr(ForecastSales, ProjId)));
        #        if(this.orig().ProjCategoryId != this.ProjCategoryId)
        #            ok= checkFailed(strFmt("@SYS113137",fieldStr(ForecastSales, ProjCategoryId)));
        #        if(this.orig().ActivityNumber != this.ActivityNumber)
        #            ok= checkFailed(strFmt("@SYS113137",fieldStr(ForecastSales, ActivityNumber)));
        #        if(this.orig().ItemId != this.ItemId)
        #            ok= checkFailed(strFmt("@SYS113137",fieldStr(ForecastSales, ItemId)));
        #        if(this.orig().ModelId != this.ModelId)
        #            ok= checkFailed(strFmt("@SYS113137",fieldStr(ForecastSales, ModelId)));
        #    }
        #
        #    if(this.ProjId && !this.ProjCategoryId)
        #        ok = checkFailed("@SYS12362");
        #
        #    if (this.ItemId && !InventTable::exist(this.ItemId))
        #        ok = checkFailed(strFmt("@SYS5307", this.ItemId));
        #
        #    if (this.SalesQty < 0)
        #        ok = checkFailed("@SYS50502");
        #
        #    if (!this.isProjLumpSum())
        #    {
        #        ok = ok && this.validateItemInfo();
        #    }
        #    ok = ok && this.checkProductDim();
        #    ok = ok && this.checkProject();
        #    ok = ok && this.checkActivity();
        #    ok = ok && this.BudgetMap::validateWrite();
        #    ok = ok && this.checkInventStatus();
        #
        #    return ok;
        #}
        #
      ENDSOURCE
      SOURCE #estimateInGroup
        #static boolean estimateInGroup(ProjId           _projId,
        #                               ForecastModelId  _modelId,
        #                               ProjCostGroupId  _costGroupId,
        #                               ProjControlId    _projControlId = "")
        #{
        #    ForecastSales       forecastSales;
        #    ProjControlCategory projControlCategory;
        #
        #    if (!_projControlId)
        #    {
        #        _projControlId = ProjWIPTable::find(ProjTable::find(_projId).wipProject).ControlId;
        #    }
        #
        #    select count(RecId) from forecastSales
        #        where forecastSales.ProjId     == _projId  &&
        #              forecastSales.ModelId    == _modelId
        #        join CategoryId from projControlCategory
        #            where projControlCategory.ControlId     == _projControlId                       &&
        #                  projControlCategory.CostGroupId   == _costGroupId                         &&
        #                  projControlCategory.CategoryId    == forecastSales.ProjCategoryId;
        #
        #    if (forecastSales.RecId > 0)
        #        return true;
        #
        #    return false;
        #}
      ENDSOURCE
      SOURCE #existProjLumpSumAllocation
        #static boolean existProjLumpSumAllocation(ForecastItemAllocationId _allocateId)
        #{
        #    ForecastSales   forecastSales;
        #    ;
        #    select firstonly forecastSales
        #    where forecastSales.ItemAllocateId == _allocateId &&
        #          forecastSales.ProjId != '';
        #
        #    if(forecastSales)
        #        return true;
        #    else
        #        return false;
        #}
      ENDSOURCE
      SOURCE #findProjectBudgetForecast
        #/// <summary>
        #/// Finds the specified record in the <c>ForecastSales</c> table.
        #/// </summary>
        #/// <param name="_projId">
        #/// A <c>ProjId</c> value that specifies the project ID of the record to find.
        #/// </param>
        #/// <param name="_categoryId">
        #/// A <c>CategoryId</c> value that specifies the category ID of the record to find.
        #/// </param>
        #/// <param name="_activityNumber">
        #/// A <c>Activity Number</c> value that specifies the activity number of the record to find.
        #/// </param>
        #/// <param name="_projForecastBudgetType">
        #/// A <c>CategoryId</c> value that specifies the forecast budget type of the record to find.
        #/// </param>
        #/// <param name="_forUpdate">
        #/// A Boolean value that indicates whether to read the record for update; optional.
        #/// </param>
        #/// <returns>
        #/// A <c>ForecastSales</c> table buffer that contains the budget forecast row.
        #/// </returns>
        #public static ForecastSales findProjectBudgetForecast(  ProjId _projId, CategoryId _categoryId,
        #                                                        ProjActivityNumber _activityNumber,
        #                                                        ProjForecastBudgetType _projForecastBudgetType,
        #                                                        boolean _forUpdate = false)
        #{
        #    ForecastSales forecastSales;
        #
        #    if (_projId && _categoryId && _projForecastBudgetType)
        #    {
        #        forecastSales.selectForUpdate(_forUpdate);
        #
        #        select firstonly forecastSales
        #        where forecastSales.ProjId == _projId
        #        &&  forecastSales.ProjCategoryId == _categoryId
        #        &&  forecastSales.ActivityNumber == _activityNumber
        #        &&  forecastSales.ProjForecastBudgetType == _projForecastBudgetType;
        #    }
        #
        #    return forecastSales;
        #}
      ENDSOURCE
      SOURCE #findProjTransId
        #static ForecastSales findProjTransId(
        #    ProjEmplTransId _transId,
        #    boolean         _forUpdate = false)
        #{
        #    ForecastSales    forecastSales;
        #    ;
        #    forecastSales.selectForUpdate(_forUpdate);
        #
        #    if (_transId)
        #        select forecastSales
        #            where forecastSales.ProjTransId == _transId;
        #
        #    return forecastSales;
        #}
      ENDSOURCE
      SOURCE #setCustGroupId
        #server static void setCustGroupId(
        #    CustAccount     accountNum,
        #    CustGroupId     orig_Group,
        #    CustGroupId     newGroup)
        #
        #{
        #    ForecastSales forecastSales;
        #
        #    ttsbegin;
        #    while select forupdate forecastSales
        #        where forecastSales.CustAccountId   == accountNum   &&
        #              forecastSales.CustGroupId     == orig_Group   &&
        #              forecastSales.ExpandId        == 0
        #    {
        #
        #        forecastSales.CustGroupId = newGroup;
        #        forecastSales.update();
        #    }
        #    ttscommit;
        #}
      ENDSOURCE
    ENDMETHODS
  ENDTABLE
  

***Element: END
